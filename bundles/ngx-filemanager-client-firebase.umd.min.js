!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("@angular/common"),require("@angular/forms"),require("@angular/common/http"),require("rxjs/operators"),require("rxjs"),require("path-browserify"),require("@angular/material/dialog"),require("uuid"),require("@angular/material/snack-bar"),require("firebase/app"),require("firebase/storage"),require("@angular/material/progress-bar"),require("@angular/material/input"),require("@angular/material/icon"),require("@angular/cdk/collections"),require("@angular/material/button"),require("@angular/material/tooltip"),require("@angular/material/menu"),require("@angular/material/toolbar"),require("@angular/cdk/keycodes"),require("@angular/material/chips"),require("@angular/material/autocomplete"),require("@angular/material/form-field"),require("@angular/material/select"),require("@angular/material/card"),require("@angular/material/button-toggle"),require("@angular/material/checkbox"),require("@angular/material/paginator"),require("@angular/material/progress-spinner"),require("@angular/material/sidenav"),require("@angular/material/sort"),require("@angular/material/table"),require("@angular/material/tabs"),require("@angular/material/expansion")):"function"==typeof define&&define.amd?define("ngx-filemanager-client-firebase",["exports","@angular/core","@angular/common","@angular/forms","@angular/common/http","rxjs/operators","rxjs","path-browserify","@angular/material/dialog","uuid","@angular/material/snack-bar","firebase/app","firebase/storage","@angular/material/progress-bar","@angular/material/input","@angular/material/icon","@angular/cdk/collections","@angular/material/button","@angular/material/tooltip","@angular/material/menu","@angular/material/toolbar","@angular/cdk/keycodes","@angular/material/chips","@angular/material/autocomplete","@angular/material/form-field","@angular/material/select","@angular/material/card","@angular/material/button-toggle","@angular/material/checkbox","@angular/material/paginator","@angular/material/progress-spinner","@angular/material/sidenav","@angular/material/sort","@angular/material/table","@angular/material/tabs","@angular/material/expansion"],t):t((e=e||self)["ngx-filemanager-client-firebase"]={},e.ng.core,e.ng.common,e.ng.forms,e.ng.common.http,e.rxjs.operators,e.rxjs,e.path,e.ng.material.dialog,e.uuid,e.ng.material.snackBar,e.firebase,null,e.ng.material.progressBar,e.ng.material.input,e.ng.material.icon,e.ng.cdk.collections,e.ng.material.button,e.ng.material.tooltip,e.ng.material.menu,e.ng.material.toolbar,e.ng.cdk.keycodes,e.ng.material.chips,e.ng.material.autocomplete,e.ng.material.formField,e.ng.material.select,e.ng.material.card,e.ng.material.buttonToggle,e.ng.material.checkbox,e.ng.material.paginator,e.ng.material.progressSpinner,e.ng.material.sidenav,e.ng.material.sort,e.ng.material.table,e.ng.material.tabs,e.ng.material.expansion)}(this,(function(e,t,n,o,r,i,s,a,l,c,u,p,h,d,f,m,g,b,y,v,w,x,k,C,S,P,F,I,O,M,D,E,R,T,A,j){"use strict";var H="default"in a?a.default:a,U="default"in p?p.default:p;function z(e){return e.getBaseHrefFromDOM()}
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */var $=function(e,t){return $=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},$(e,t)};function _(e,t,n,o){return new(n||(n=Promise))((function(r,i){function s(e){try{l(o.next(e))}catch(e){i(e)}}function a(e){try{l(o.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((o=o.apply(e,t||[])).next())}))}function N(e,t){var n,o,r,i,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,o=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(r=s.trys,(r=r.length>0&&r[r.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){s.label=i[1];break}if(6===i[0]&&s.label<r[1]){s.label=r[1],r=i;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(i);break}r[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}}function L(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var o,r,i=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(o=i.next()).done;)s.push(o.value)}catch(e){r={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return s}function B(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(L(arguments[t]));return e}var G=function(){};G.decorators=[{type:t.Injectable}];var q=function(){function e(e,t){this.dialogRef=e,this.data=t,this.renamedItem=new o.FormControl;var n=H.basename(t.currentPath);this.renamedItem.setValue(n)}return e.prototype.onSubmit=function(){var e=this.newPath;this.dialogRef.close(e)},e.prototype.onCancel=function(){this.dialogRef.close()},Object.defineProperty(e.prototype,"newPath",{get:function(){var e=H.dirname(this.data.currentPath),t=this.renamedItem.value;return this.IsDir?H.join(e,t,"/"):H.join(e,t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"IsDir",{get:function(){return this.data.currentPath.endsWith("/")},enumerable:!1,configurable:!0}),e}();function V(e){return e.replace(/^\/+|\/+$/g,"")}function W(e){return!(!e||!e.length)&&e.endsWith("/")}function K(e){var t=function(e){return!(!e||!e.length)&&e.startsWith("/")}(e);return t?e:"/"+e}function Q(e){return W(e)?e:e+"/"}function Y(e){return Q(K(e))}function J(e){return W(e)?e.slice(0,-1):e}function Z(e){var t=e.split("."),n=t.pop();return t.join(".")+" (2)."+n}function X(e){return Q(J(e)+" (2)")}q.decorators=[{type:t.Component,args:[{template:'\n    <base-dialog\n      [header]="headerTemplate"\n      [body]="bodyTemplate"\n      [actions]="actionsTemplate"\n    >\n      <ng-template #headerTemplate>\n        <h2>Rename Item</h2>\n      </ng-template>\n      <ng-template #bodyTemplate>\n        <h5 class="p5 m0">Old Path: {{ data.currentPath }}</h5>\n        <h5 class="p5 m0">New Path: {{ newPath }}</h5>\n\n        <mat-form-field>\n          <input\n            matInput\n            placeholder="New Name"\n            [formControl]="renamedItem"\n            (keyup.enter)="onSubmit()"\n          />\n        </mat-form-field>\n      </ng-template>\n      <ng-template #actionsTemplate>\n        <btns-cancel-ok\n          okIcon="done"\n          okLabel="Rename Item"\n          (clickedCancel)="onCancel()"\n          (clickedOk)="onSubmit()"\n        >\n        </btns-cancel-ok>\n      </ng-template>\n    </base-dialog>\n  ',styles:["h1,h2,h3,h4,h5,h6,i,mat-chip,p,small,span{font-family:sans-serif}.is-red{background:red}.flex-col{display:flex;flex-direction:column}.flex-row{display:flex;flex-direction:row}.align-center{align-items:center}.align-top{align-items:start}.align-bottom{align-items:end}.fit-content{width:-moz-fit-content;width:fit-content}.sans-serif{font-family:sans-serif}.has-pointer{cursor:pointer}.has-ellipsis{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.scroll-x{overflow-x:auto}.full-width{width:100%}.text-center{text-align:center}.space-between{justify-content:space-between}.break-word{overflow-wrap:break-word;word-break:break-all}.capitalize{text-transform:capitalize}.p5{padding:5px}.m0{margin:0}.mb-10{margin-bottom:10px}.mr-10{margin-right:10px}.m-10{margin:10px}.color-grey{color:#8c8c8c}.rounded{border-radius:5px}.bg-grey-light{background-color:rgba(95,95,95,.2)}.bg-grey-dark{background-color:rgba(50,50,50,.39)}.bg-grey-hover{transition:background-color .5s}.bg-grey-hover:hover{background-color:rgba(95,95,95,.336)}.color-white{color:#fff}.color-grey-hover{transition:color .5s}.color-grey-hover:hover{color:#444}.color-black{color:#000}.action-toolbar{height:55px}.top-toolbar-label{font-size:.8em;margin:0}.top-toolbar{height:20px;padding-top:3px}"]}]}],q.ctorParameters=function(){return[{type:l.MatDialogRef},{type:void 0,decorators:[{type:t.Inject,args:[l.MAT_DIALOG_DATA]}]}]};var ee=function(){function e(e,t,n){this.logger=e,this.dialogRef=t,this.data=n,this.destroyed=new s.Subject,this.$copyPathChanged=new s.BehaviorSubject(null),this.init().catch((function(e){return console.error(e)}))}return e.prototype.init=function(){return _(this,void 0,void 0,(function(){var e,t,n=this;return N(this,(function(o){switch(o.label){case 0:return this.logger.info("initializing dialog:",{data:this.data}),this.items=this.data.files,this.data.isCopy?(this.OkLabel="Copy",this.OkIcon="content_copy"):(this.OkLabel="Move",this.OkIcon="forward"),e=this,[4,this.data.actionHandler.CloneProvider()];case 1:return e.actionHandlers=o.sent(),this.mainActions=[{label:"Home",icon:"home",onClick:function(){return _(n,void 0,void 0,(function(){var e;return N(this,(function(t){switch(t.label){case 0:return this.logger.info("Back clicked"),e=this.actionHandlers.GetRootPath(),[4,this.actionHandlers.OnNavigateTo(e)];case 1:return t.sent(),this.onSelectedDirectory(e),[2,this.onSelectedDirectory(e)]}}))}))},$disabled:s.combineLatest([this.actionHandlers.$CurrentPathIsRoot,this.$copyPathChanged]).pipe(i.map((function(e){var t=L(e,2);t[0],t[1];return n.DisableCopy})))},{label:"Back",icon:"reply",onClick:function(){return _(n,void 0,void 0,(function(){var e;return N(this,(function(t){switch(t.label){case 0:return this.logger.info("Back clicked"),[4,this.actionHandlers.OnNavigateToParent()];case 1:return t.sent(),[4,this.actionHandlers.GetCurrentPath()];case 2:return e=t.sent(),[2,this.onSelectedDirectory(e)]}}))}))},$disabled:this.actionHandlers.$CurrentPathIsRoot},{label:"New Folder",icon:"create_new_folder",onClick:function(){return _(n,void 0,void 0,(function(){return N(this,(function(e){return[2,this.actionHandlers.OnNewFolderInCurrentDirectory()]}))}))}}],this.actionHandlers.$FilesWithIcons.pipe(i.takeUntil(this.destroyed)).subscribe((function(e){n.folders=e.filter((function(e){return"dir"===e.type}))})),t=B(this.items).pop(),this.setSrcDirectory(t.fullPath),this.setCopyToPath(this.actionHandlers.GetRootPath()),[2]}}))}))},e.prototype.ngOnDestroy=function(){this.destroyed.next()},Object.defineProperty(e.prototype,"SelectedFolder",{get:function(){return!!this.copyToPath},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"SameAsSrcFolder",{get:function(){return this.copyToPath===this.srcDirectory},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"DisableCopy",{get:function(){return!this.SelectedFolder||this.SameAsSrcFolder},enumerable:!1,configurable:!0}),e.prototype.setCopyToPath=function(e){var t=Q(e);this.copyToPath=t,this.$copyPathChanged.next(t),this.copyToPathRelative=this.actionHandlers.ConvertToRelativePath(t),this.logger.info("setCopyToPath:",{inputPath:e,copyToPath:this.copyToPath,copyToPathRelative:this.copyToPathRelative})},e.prototype.setSrcDirectory=function(e){var t=Q(H.dirname(e));this.srcDirectory=t,this.logger.info("setSrcDirectory:",{inputPath:e,srcDirectory:this.srcDirectory})},e.prototype.onEnterDirectory=function(e){return this.logger.info("onEnterDirectory:",{directoryPath:e}),this.setCopyToPath(e),this.actionHandlers.OnNavigateTo(e)},e.prototype.onSelectedDirectory=function(e){this.logger.info("onSelectedDirectory:",{directoryPath:e}),this.setCopyToPath(e)},e.prototype.onSubmit=function(){this.dialogRef.close(this.copyToPath)},e.prototype.onCancel=function(){this.dialogRef.close()},e}();ee.decorators=[{type:t.Component,args:[{template:'\n    <base-dialog\n      *ngIf="srcDirectory"\n      [header]="headerTemplate"\n      [body]="bodyTemplate"\n      [actions]="actionsTemplate"\n    >\n      <ng-template #headerTemplate>\n        <h2>{{ OkLabel }} Items</h2>\n      </ng-template>\n      <ng-template #bodyTemplate>\n        <h5 class="my-5">Selected Items</h5>\n        <mat-chip-list class="mb-5">\n          <mat-chip *ngFor="let file of items">\n            <mat-icon *ngIf="file.type === \'file\'">description</mat-icon>\n            <mat-icon *ngIf="file.type !== \'file\'">folder</mat-icon>\n            {{ file.name }}\n          </mat-chip>\n        </mat-chip-list>\n        <h5 class="my-5">Navigate to destination folder</h5>\n        <div class="full-width">\n          <mat-card class="m-10 bg-grey">\n            <app-file-table-mini-folder-browser\n              [folders]="folders"\n              [mainActions]="mainActions"\n              (enterDirectory)="onEnterDirectory($event)"\n              (selectedDirectory)="onSelectedDirectory($event)"\n            >\n            </app-file-table-mini-folder-browser>\n          </mat-card>\n        </div>\n      </ng-template>\n      <ng-template #actionsTemplate>\n        <h5 class="p5 m0" *ngIf="!SelectedFolder">No folder selected</h5>\n        <h5 class="p5 m0" *ngIf="SameAsSrcFolder">\n          Cannot copy to the same folder\n        </h5>\n        <h5 class="p5 m0" *ngIf="!DisableCopy">\n          Will copy Selected Items to:\n          <strong *ngIf="!copyToPathRelative">/</strong>\n          <strong>{{ copyToPathRelative }}</strong>\n        </h5>\n        <btns-cancel-ok\n          [okIcon]="OkIcon"\n          [okLabel]="OkLabel"\n          [okDisabled]="DisableCopy"\n          (clickedCancel)="onCancel()"\n          (clickedOk)="onSubmit()"\n        >\n        </btns-cancel-ok>\n      </ng-template>\n    </base-dialog>\n  ',styles:["\n      .bg-grey {\n        background-color: #eee;\n      }\n    ","h1,h2,h3,h4,h5,h6,i,mat-chip,p,small,span{font-family:sans-serif}.is-red{background:red}.flex-col{display:flex;flex-direction:column}.flex-row{display:flex;flex-direction:row}.align-center{align-items:center}.align-top{align-items:start}.align-bottom{align-items:end}.fit-content{width:-moz-fit-content;width:fit-content}.sans-serif{font-family:sans-serif}.has-pointer{cursor:pointer}.has-ellipsis{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.scroll-x{overflow-x:auto}.full-width{width:100%}.text-center{text-align:center}.space-between{justify-content:space-between}.break-word{overflow-wrap:break-word;word-break:break-all}.capitalize{text-transform:capitalize}.p5{padding:5px}.m0{margin:0}.mb-10{margin-bottom:10px}.mr-10{margin-right:10px}.m-10{margin:10px}.color-grey{color:#8c8c8c}.rounded{border-radius:5px}.bg-grey-light{background-color:rgba(95,95,95,.2)}.bg-grey-dark{background-color:rgba(50,50,50,.39)}.bg-grey-hover{transition:background-color .5s}.bg-grey-hover:hover{background-color:rgba(95,95,95,.336)}.color-white{color:#fff}.color-grey-hover{transition:color .5s}.color-grey-hover:hover{color:#444}.color-black{color:#000}.action-toolbar{height:55px}.top-toolbar-label{font-size:.8em;margin:0}.top-toolbar{height:20px;padding-top:3px}"]}]}],ee.ctorParameters=function(){return[{type:G},{type:l.MatDialogRef},{type:void 0,decorators:[{type:t.Inject,args:[l.MAT_DIALOG_DATA]}]}]};var te=function(){function e(e,t,n){var r=this;this.logger=e,this.dialogRef=t,this.data=n,this.othersControl=new o.FormControl,this.othersOptions=["read/write","read","hidden"],this.allReadersControl=new o.FormControl([]),this.allWritersControl=new o.FormControl([]),this.destroyed=new s.Subject,this.logger.info("Initializing setobject dialog",{data:n}),this.items=n.files,this.config=n.config;var a=this.config.users,l=this.config.groups;this.$allEntities=s.combineLatest([l,a]).pipe(i.tap((function(e){return r.logger.info("allEntities",{allEntities:e})})),i.map((function(e){var t=[{uid:"",name:"Groups: ",isDisabled:!0}];return(t=t.concat(e[0])).push({uid:"",name:"Users: ",isDisabled:!0}),t.concat(e[1])})),i.map((function(e){return e.map((function(e){return{id:e.uid,name:e.name,isDisabled:!!e.isDisabled}}))}))),this.$allEntities.subscribe((function(e){return r.logger.info("allEntities",{allEntities:e})})),this.initPermissions(n.files)}return e.prototype.ngOnDestroy=function(){this.destroyed.next()},e.prototype.initPermissions=function(e){var t=e.map((function(e){return e.permissions})),n=t.map((function(e){return e.others})).reduce((function(e,t){return"-"===e?t:e===t?e:null}),"-");n&&this.othersControl.setValue(n);var o=this.getUniqueTags(t.map((function(e){return e.writers})));this.allWritersControl.setValue(o);var r=this.getUniqueTags(t.map((function(e){return e.readers})));this.allReadersControl.setValue(r),this.logger.info("set permissions",{othersVal:n,uniqueWriters:o,uniqueReaders:r})},e.prototype.getUniqueTags=function(e){var t=e.reduce((function(e,t){return e.concat(t)}),[]),n=Array.from(new Set(t));return this.strings2Tags(n)},e.prototype.strings2Tags=function(e){return e.map((function(e){return{id:c.v4(),name:e}}))},e.prototype.tags2Strings=function(e){return e.map((function(e){return e.name}))},e.prototype.onSubmit=function(){var e={others:this.othersControl.value,readers:this.tags2Strings(this.allReadersControl.value),writers:this.tags2Strings(this.allWritersControl.value)},t={permissionsObj:e,files:this.data.files};this.logger.info("onSubmit",{newPermissionsObj:e,response:t}),this.dialogRef.close(t)},e.prototype.onCancel=function(){this.dialogRef.close()},e}();te.decorators=[{type:t.Component,args:[{template:'\n    <base-dialog\n      [header]="headerTemplate"\n      [body]="bodyTemplate"\n      [actions]="actionsTemplate"\n    >\n      <ng-template #headerTemplate>\n        <h2>Set Permissions</h2>\n      </ng-template>\n      <ng-template #bodyTemplate>\n        <h5 class="my-5">Selected Items</h5>\n        <mat-chip-list class="mb-5">\n          <mat-chip *ngFor="let file of items">\n            <mat-icon *ngIf="file.type === \'file\'">description</mat-icon>\n            <mat-icon *ngIf="file.type !== \'file\'">folder</mat-icon>\n            {{ file.name }}\n          </mat-chip>\n        </mat-chip-list>\n\n        <div class="full-width">\n          <h5 class="my-5">Who can see this</h5>\n          <app-control-tag-multiple\n            class="full-width -mt-15"\n            [control]="allReadersControl"\n            [selectChoices$]="$allEntities"\n            [allowCustom]="false"\n          >\n          </app-control-tag-multiple>\n        </div>\n\n        <div *ngIf="config?.showWriters">\n          <h5 class="my-5">Who can edit this</h5>\n          <app-control-tag-multiple\n            class="full-width -mt-15"\n            [control]="allWritersControl"\n            [selectChoices$]="$allEntities"\n            [allowCustom]="false"\n          >\n          </app-control-tag-multiple>\n        </div>\n\n        <div *ngIf="config?.showOthers">\n          <h5 class="my-5">Everyone else can</h5>\n          <mat-form-field class="full-width">\n            <mat-select matInput [formControl]="othersControl">\n              <mat-option\n                *ngFor="let permission of othersOptions"\n                [value]="permission"\n              >\n                {{ permission }}\n              </mat-option>\n            </mat-select>\n          </mat-form-field>\n        </div>\n      </ng-template>\n\n      <ng-template #actionsTemplate>\n        <btns-cancel-ok\n          okIcon="done"\n          okLabel="Set Permissions"\n          (clickedCancel)="onCancel()"\n          (clickedOk)="onSubmit()"\n        >\n        </btns-cancel-ok>\n      </ng-template>\n    </base-dialog>\n  ',styles:["h1,h2,h3,h4,h5,h6,i,mat-chip,p,small,span{font-family:sans-serif}.is-red{background:red}.flex-col{display:flex;flex-direction:column}.flex-row{display:flex;flex-direction:row}.align-center{align-items:center}.align-top{align-items:start}.align-bottom{align-items:end}.fit-content{width:-moz-fit-content;width:fit-content}.sans-serif{font-family:sans-serif}.has-pointer{cursor:pointer}.has-ellipsis{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.scroll-x{overflow-x:auto}.full-width{width:100%}.text-center{text-align:center}.space-between{justify-content:space-between}.break-word{overflow-wrap:break-word;word-break:break-all}.capitalize{text-transform:capitalize}.p5{padding:5px}.m0{margin:0}.mb-10{margin-bottom:10px}.mr-10{margin-right:10px}.m-10{margin:10px}.color-grey{color:#8c8c8c}.rounded{border-radius:5px}.bg-grey-light{background-color:rgba(95,95,95,.2)}.bg-grey-dark{background-color:rgba(50,50,50,.39)}.bg-grey-hover{transition:background-color .5s}.bg-grey-hover:hover{background-color:rgba(95,95,95,.336)}.color-white{color:#fff}.color-grey-hover{transition:color .5s}.color-grey-hover:hover{color:#444}.color-black{color:#000}.action-toolbar{height:55px}.top-toolbar-label{font-size:.8em;margin:0}.top-toolbar{height:20px;padding-top:3px}","\n      .my-5 {\n        margin: 5px 0;\n      }\n      .mb-5 {\n        margin-bottom: 5px;\n      }\n      .-mt-15 {\n        margin-top: -15px;\n      }\n    "]}]}],te.ctorParameters=function(){return[{type:G},{type:l.MatDialogRef},{type:void 0,decorators:[{type:t.Inject,args:[l.MAT_DIALOG_DATA]}]}]};var ne=function(){function e(e){this.matSnackbar=e}return e.prototype.notify=function(e,t){return this.matSnackbar.open(e,t,{duration:4e3,horizontalPosition:"center",verticalPosition:"bottom"})},e.prototype.notifyCancelled=function(){return this.notify("Cancelled Operation")},e}();ne.decorators=[{type:t.Injectable}],ne.ctorParameters=function(){return[{type:u.MatSnackBar}]};var oe=function(){function e(e,t,n,r){this.logger=e,this.notifications=t,this.dialogRef=n,this.data=r,this.filesControl=new o.FormControl([]),this.currentDirectory="",this.isUploading=new s.BehaviorSubject(!0),this.config={directory:r.currentDirectory,bucketname:r.bucketName,firebaseConfig:r.firebaseConfig},this.logger.info("initializing:",{currentDirectory:this.currentDirectory,config:this.config,data:r})}return e.prototype.onSubmit=function(){var e={uploaded:this.filesControl.value.map((function(e){return e.value.name}))};this.dialogRef.close(e)},e.prototype.onCancel=function(){this.dialogRef.close({uploaded:[]})},e}();oe.decorators=[{type:t.Component,args:[{template:'\n    <base-dialog\n      [header]="headerTemplate"\n      [body]="bodyTemplate"\n      [actions]="actionsTemplate"\n    >\n      <ng-template #headerTemplate>\n        <h2>Upload Files</h2>\n        <h5>To Folder: {{ currentDirectory }}</h5>\n      </ng-template>\n      <ng-template #bodyTemplate>\n        <div style="width: 100%;">\n          <form-file-firebase\n            [formControl]="filesControl"\n            [config]="config"\n            (uploadStatusChanged)="isUploading.next($event)"\n          >\n          </form-file-firebase>\n        </div>\n      </ng-template>\n      <ng-template #actionsTemplate>\n        <btns-cancel-ok\n          okIcon="done"\n          okLabel="Finish"\n          (clickedCancel)="onCancel()"\n          (clickedOk)="onSubmit()"\n          [okDisabled]="isUploading | async"\n        >\n        </btns-cancel-ok>\n      </ng-template>\n    </base-dialog>\n    <div #hidden></div>\n  ',styles:["\n      .dz-image {\n        display: none;\n      }\n      .dz-details > img {\n        display: none;\n      }\n    ","h1,h2,h3,h4,h5,h6,i,mat-chip,p,small,span{font-family:sans-serif}.is-red{background:red}.flex-col{display:flex;flex-direction:column}.flex-row{display:flex;flex-direction:row}.align-center{align-items:center}.align-top{align-items:start}.align-bottom{align-items:end}.fit-content{width:-moz-fit-content;width:fit-content}.sans-serif{font-family:sans-serif}.has-pointer{cursor:pointer}.has-ellipsis{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.scroll-x{overflow-x:auto}.full-width{width:100%}.text-center{text-align:center}.space-between{justify-content:space-between}.break-word{overflow-wrap:break-word;word-break:break-all}.capitalize{text-transform:capitalize}.p5{padding:5px}.m0{margin:0}.mb-10{margin-bottom:10px}.mr-10{margin-right:10px}.m-10{margin:10px}.color-grey{color:#8c8c8c}.rounded{border-radius:5px}.bg-grey-light{background-color:rgba(95,95,95,.2)}.bg-grey-dark{background-color:rgba(50,50,50,.39)}.bg-grey-hover{transition:background-color .5s}.bg-grey-hover:hover{background-color:rgba(95,95,95,.336)}.color-white{color:#fff}.color-grey-hover{transition:color .5s}.color-grey-hover:hover{color:#444}.color-black{color:#000}.action-toolbar{height:55px}.top-toolbar-label{font-size:.8em;margin:0}.top-toolbar{height:20px;padding-top:3px}"]}]}],oe.ctorParameters=function(){return[{type:G},{type:ne},{type:l.MatDialogRef},{type:void 0,decorators:[{type:t.Inject,args:[l.MAT_DIALOG_DATA]}]}]};var re=function(){function e(e){this.dialogRef=e,this.folderName=new o.FormControl("New folder")}return e.prototype.onSubmit=function(){this.dialogRef.close(this.folderName.value)},e.prototype.onCancel=function(){this.dialogRef.close()},e}();re.decorators=[{type:t.Component,args:[{template:'\n    <base-dialog\n      [header]="headerTemplate"\n      [body]="bodyTemplate"\n      [actions]="actionsTemplate"\n    >\n      <ng-template #headerTemplate>\n        <h2>Create Folder</h2>\n      </ng-template>\n      <ng-template #bodyTemplate>\n        <div>\n          <mat-form-field>\n            <input\n              matInput\n              placeholder="New Folder Name"\n              [formControl]="folderName"\n              (keyup.enter)="onSubmit()"\n            />\n          </mat-form-field>\n        </div>\n      </ng-template>\n      <ng-template #actionsTemplate>\n        <btns-cancel-ok\n          okIcon="done"\n          okLabel="Create Folder"\n          (clickedCancel)="onCancel()"\n          (clickedOk)="onSubmit()"\n        >\n        </btns-cancel-ok>\n      </ng-template>\n    </base-dialog>\n  ',styles:["h1,h2,h3,h4,h5,h6,i,mat-chip,p,small,span{font-family:sans-serif}.is-red{background:red}.flex-col{display:flex;flex-direction:column}.flex-row{display:flex;flex-direction:row}.align-center{align-items:center}.align-top{align-items:start}.align-bottom{align-items:end}.fit-content{width:-moz-fit-content;width:fit-content}.sans-serif{font-family:sans-serif}.has-pointer{cursor:pointer}.has-ellipsis{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.scroll-x{overflow-x:auto}.full-width{width:100%}.text-center{text-align:center}.space-between{justify-content:space-between}.break-word{overflow-wrap:break-word;word-break:break-all}.capitalize{text-transform:capitalize}.p5{padding:5px}.m0{margin:0}.mb-10{margin-bottom:10px}.mr-10{margin-right:10px}.m-10{margin:10px}.color-grey{color:#8c8c8c}.rounded{border-radius:5px}.bg-grey-light{background-color:rgba(95,95,95,.2)}.bg-grey-dark{background-color:rgba(50,50,50,.39)}.bg-grey-hover{transition:background-color .5s}.bg-grey-hover:hover{background-color:rgba(95,95,95,.336)}.color-white{color:#fff}.color-grey-hover{transition:color .5s}.color-grey-hover:hover{color:#444}.color-black{color:#000}.action-toolbar{height:55px}.top-toolbar-label{font-size:.8em;margin:0}.top-toolbar{height:20px;padding-top:3px}"]}]}],re.ctorParameters=function(){return[{type:l.MatDialogRef}]};var ie=function(){function e(){}return Object.defineProperty(e.prototype,"info",{get:function(){return console.log.bind(console,"ngx-fm:: ")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"warn",{get:function(){return console.warn.bind(console,"ngx-fm:: ")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"error",{get:function(){return console.error.bind(console,"ngx-fm:: ")},enumerable:!1,configurable:!0}),e}();ie.decorators=[{type:t.Injectable}];var se=function(){function e(){this.logger=new ie,this.cachedFolders={},this.cacheLimit=20}return e.prototype.GetCached=function(e){var t=Q(e);return this.cachedFolders[t]||[]},e.prototype.SetCached=function(e,t){var n=Q(e),o=this.GetCached(n);this.logger.info("SetCached()",{from:o.length,to:t.length}),this.cachedCount>this.cacheLimit&&this.removeRandomFolderPath(),this.cachedFolders[n]=t},Object.defineProperty(e.prototype,"cachedCount",{get:function(){return Object.keys(this.cachedFolders).length},enumerable:!1,configurable:!0}),e.prototype.removeRandomFolderPath=function(){var e=Math.floor(Math.random()*this.cachedCount),t=Object.keys(this.cachedFolders)[e];delete this.cachedFolders[t]},e}();var ae=function(){function e(){this.cache=new se,this._$currentFiles=new s.BehaviorSubject([]),this._$currentPath=new s.BehaviorSubject(null),this._$selectedFile=new s.BehaviorSubject(null),this.logger=new ie}return e.prototype.SetCache=function(e){this.cache=e},Object.defineProperty(e.prototype,"$currentFiles",{get:function(){return this._$currentFiles},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"$currentPath",{get:function(){return this._$currentPath},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"$selectedFile",{get:function(){return this._$selectedFile},enumerable:!1,configurable:!0}),e.prototype.CurrentPath=function(){return this._$currentPath.value},e.prototype.CurrentFiles=function(){return this._$currentFiles.value},e.prototype.GetCached=function(e){return this.cache.GetCached(e)},e.prototype.SetDirectoryFiles=function(e,t){this.cache.SetCached(t,e)},e.prototype.SetPath=function(e){var t=K(e);this.logger.info("datastore.SetPath",{path:e,pathParsed:t});var n=this.cache.GetCached(t);this._$currentPath.next(t),this._$currentFiles.next(n)},e.prototype.SelectFile=function(e){this._$selectedFile.next(e)},e.prototype.exists=function(e,t){return!!this.cache.GetCached(t).find((function(t){return t.fullPath===e}))},e.prototype.CloneStore=function(){var t=new e;return t.SetPath(this.CurrentPath()),t.SetDirectoryFiles(this._$currentFiles.getValue(),this.CurrentPath()),t.SetCache(this.cache),t},e}();var le={defaultIcon:{name:"file"},icons:[{name:"word",fileExtensions:["doc","docx","rtf"]},{name:"pdf",fileExtensions:["pdf"]},{name:"table",fileExtensions:["xlsx","xls","csv","tsv"]},{name:"html",fileExtensions:["html","htm","xhtml","html_vm","asp"]},{name:"markdown",fileExtensions:["md","markdown","rst"]},{name:"yaml",fileExtensions:["yaml","YAML-tmLanguage","yml"]},{name:"xml",fileExtensions:["xml","plist","xsd","dtd","xsl","xslt","resx","iml","xquery","tmLanguage","manifest","project"],fileNames:[".htaccess"]},{name:"image",fileExtensions:["png","jpeg","jpg","gif","svg","ico","tif","tiff","psd","psb","ami","apx","bmp","bpg","brk","cur","dds","dng","exr","fpx","gbr","img","jbig2","jb2","jng","jxr","pbm","pgf","pic","raw","webp","eps"]},{name:"tex",fileExtensions:["tex","cls","sty"]},{name:"powerpoint",fileExtensions:["pptx","ppt","pptm","potx","potm","ppsx","ppsm","pps","ppam","ppa"]},{name:"video",fileExtensions:["webm","mkv","flv","vob","ogv","ogg","gifv","avi","mov","qt","wmv","yuv","rm","rmvb","mp4","m4v","mpg","mp2","mpeg","mpe","mpv","m2v"]},{name:"audio",fileExtensions:["mp3","flac","m4a","wma","aiff"]},{name:"document",fileExtensions:["txt"]}]},ce=function(e){if(!e||!e.includes("."))return le.defaultIcon.name;var t=e.toLowerCase(),n=ue(t),o=le.icons.filter((function(e){return!!e.fileExtensions&&!!e.fileExtensions.filter((function(e){return e===n})).length})),r=le.icons.filter((function(e){return!!e.fileNames&&!!e.fileNames.filter((function(e){return e===t})).length}));return r.length?r[0].name:o.length?o[0].name:le.defaultIcon.name},ue=function(e){return e.split(".").pop()},pe=function(e){return"folder-other"},he=pe,de=ce,fe=function(){function e(e){this.baseHref=e,this.iconAssetDirectory="/assets/fileicons/"}return e.prototype.getFileIconUrl=function(e){return H.join(this.baseHref,this.iconAssetDirectory,de(e)+".svg")},e.prototype.getFolderIconUrl=function(e){return H.join(this.baseHref,this.iconAssetDirectory,he(e)+".svg")},e}();fe.decorators=[{type:t.Injectable}],fe.ctorParameters=function(){return[{type:String,decorators:[{type:t.Inject,args:[n.APP_BASE_HREF]}]}]};var me=function(){function e(e,t){this.logger=e,this.iconResolver=t,this.store=new ae,this.instanceCountIncr()}return Object.defineProperty(e.prototype,"$currentFiles",{get:function(){return this.store.$currentFiles},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"$currentPath",{get:function(){return this.store.$currentPath},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"$selectedFile",{get:function(){return this.store.$selectedFile},enumerable:!1,configurable:!0}),e.prototype.instanceCountIncr=function(){e.instanceCount++,this.logger.info("new instance created",{instances:this.instances})},e.prototype.instanceCountDecr=function(){e.instanceCount--,this.logger.info("instance destroyed",{instances:this.instances})},Object.defineProperty(e.prototype,"instances",{get:function(){return e.instanceCount},enumerable:!1,configurable:!0}),e.prototype.ngOnDestroy=function(){this.instanceCountDecr()},e.prototype.SetStore=function(e){this.store=e},e.prototype.OnList=function(e){return _(this,void 0,void 0,(function(){return N(this,(function(t){return this.logger.info("client.OnList",{folderPath:e}),this.store.SetPath(e),[2]}))}))},e.prototype.OnCreateFolder=function(e,t){return _(this,void 0,void 0,(function(){var t,n,o,r,i;return N(this,(function(s){return t=a.dirname(e),n=this.store.GetCached(t),o=this.getNextFreeFoldernameRecursively(e,t),r=a.basename(o),i={name:r,fullPath:o,rightsFirebase:[],permissions:{},size:null,date:(new Date).toISOString(),type:"dir"},n.unshift(i),this.store.SetDirectoryFiles(n,t),this.store.SetPath(t),[2]}))}))},e.prototype.OnUploadedFiles=function(e){return _(this,void 0,void 0,(function(){var t,n=this;return N(this,(function(o){return Array.isArray(e)&&e.length?(t=this.store.CurrentPath(),e.map((function(e){return n.recursivelyTryAddFile(t,e)})),[2]):[2]}))}))},e.prototype.recursivelyTryAddFile=function(e,t){var n=J(t);if(this.store.exists(n,e)){var o,r=Z(n);return this.recursivelyTryAddFile(e,r)}var i=(o=t,{name:H.basename(o),fullPath:o,rightsFirebase:[],permissions:{},size:null,date:(new Date).toISOString(),type:"file"}),s=B(this.store.GetCached(e),[i]);this.store.SetDirectoryFiles(s,e)},e.prototype.OnCopy=function(e,t){return _(this,void 0,void 0,(function(){return N(this,(function(e){return[2]}))}))},e.prototype.OnMove=function(e,t){return _(this,void 0,void 0,(function(){return N(this,(function(t){return[2,this.removeSingleFromList(e)]}))}))},e.prototype.OnRename=function(e,t){return _(this,void 0,void 0,(function(){return N(this,(function(e){return[2]}))}))},e.prototype.OnEdit=function(e,t){return _(this,void 0,void 0,(function(){return N(this,(function(e){return[2]}))}))},e.prototype.OnGetcontent=function(e){return _(this,void 0,void 0,(function(){return N(this,(function(e){return[2]}))}))},e.prototype.OnSetPermissions=function(e,t,n,o){return _(this,void 0,void 0,(function(){return N(this,(function(e){return[2]}))}))},e.prototype.OnMoveMultiple=function(e,t){return _(this,void 0,void 0,(function(){return N(this,(function(t){return[2,this.removeMultiple(e)]}))}))},e.prototype.OnCopyMultiple=function(e,t){return _(this,void 0,void 0,(function(){return N(this,(function(e){return[2]}))}))},e.prototype.OnSetPermissionsMultiple=function(e,t,n,o){return _(this,void 0,void 0,(function(){return N(this,(function(e){return[2]}))}))},e.prototype.OnSetPermissionsObjectMultiple=function(e,t,n){return _(this,void 0,void 0,(function(){var n;return N(this,(function(o){switch(o.label){case 0:return[4,this.$selectedFile.pipe(i.take(1)).toPromise()];case 1:return n=o.sent(),e.includes(n.fullPath)&&(n.permissions=t,this.store.SelectFile(n)),[2]}}))}))},e.prototype.OnRemove=function(e){return _(this,void 0,void 0,(function(){return N(this,(function(t){return[2,this.removeMultiple(e)]}))}))},e.prototype.UpdateList=function(e,t){return _(this,void 0,void 0,(function(){return N(this,(function(n){return this.store.SetDirectoryFiles(e.result,t),[2]}))}))},e.prototype.getNextFreeFoldernameRecursively=function(e,t){var n=Q(e);if(!this.store.exists(n,t))return e;var o=X(n);return this.getNextFreeFoldernameRecursively(o,t)},e.prototype.removeSingleFromList=function(e){return _(this,void 0,void 0,(function(){var t,n,o,r;return N(this,(function(i){return t=a.dirname(e),n=this.store.GetCached(e),o=this.GetFileNameFromPath(e),r=n.filter((function(e){return e.name!==o})),this.store.SetDirectoryFiles(r,t),[2]}))}))},e.prototype.EnsureNoTrailingSlash=function(e){return"/"===e.slice(-1)?e.slice(0,-1):e},e.prototype.GetFileNameFromPath=function(e){var t=e||"";return this.EnsureNoTrailingSlash(t).split("/").pop()},e.prototype.removeMultiple=function(e){return _(this,void 0,void 0,(function(){var t,n,o,r,i;return N(this,(function(s){return(t=e[0])?(n=a.dirname(t),o=new Set(e.map((function(e){return a.basename(e)}))),r=this.store.GetCached(n),i=r.filter((function(e){return!o.has(e.name)})),this.store.SetDirectoryFiles(i,n),this.store.SetPath(n),[2]):[2]}))}))},Object.defineProperty(e.prototype,"$FilesWithIcons",{get:function(){var e=this;return this.$currentFiles.pipe(i.map((function(e){return e||[]})),i.map((function(t){return t.map((function(t){return e.addIconPath(t)}))})),i.map((function(e){return e.map((function(e){return Object.assign({},e)}))})))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"$NoParentFolder",{get:function(){return this.$currentPath.pipe(i.filter((function(e){return!!e})),i.map((function(e){return e.split("/").length<2})))},enumerable:!1,configurable:!0}),e.prototype.onSelectItem=function(e){this.store.SelectFile(e)},e.prototype.CurrentFiles=function(){return this.store.CurrentFiles()},e.prototype.addIconPath=function(e){return"file"===e.type?e.icon=this.iconResolver.getFileIconUrl(e.name):e.icon=this.iconResolver.getFolderIconUrl(e.name),e},e.prototype.CloneProvider=function(){var t=new e(this.logger,this.iconResolver),n=this.store.CloneStore();return t.SetStore(n),t},e}();me.instanceCount=0,me.decorators=[{type:t.Injectable}],me.ctorParameters=function(){return[{type:G},{type:fe}]};var ge=function(){function e(){this._ActiveRequestsMap=new s.BehaviorSubject({})}return Object.defineProperty(e.prototype,"ActiveRequestsMap",{get:function(){return this._ActiveRequestsMap},enumerable:!1,configurable:!0}),e.prototype.UpdateStatus=function(e,t,n){var o;console.log("UpdateStatus()",{key:e,status:t,error:n}),(o=this._ActiveRequestsMap.value)[e]||(o[e]={}),o[e].status=t,o[e].error=n,this._ActiveRequestsMap.next(o)},e}();ge.decorators=[{type:t.Injectable,args:[{providedIn:"root"}]}],ge.ɵprov=t.ɵɵdefineInjectable({factory:function(){return new ge},token:ge,providedIn:"root"});var be=function(){function e(e,t,n){this.logger=e,this.notifications=t,this.status=n,this.refreshEmitter=new s.Subject,this.destroyed=new s.Subject,this.instanceCountIncr()}return e.prototype.instanceCountIncr=function(){e.instanceCount++,this.logger.info("new instance created",{instances:this.instances})},e.prototype.instanceCountDecr=function(){e.instanceCount--,this.logger.info("instance destroyed",{instances:this.instances})},Object.defineProperty(e.prototype,"instances",{get:function(){return e.instanceCount},enumerable:!1,configurable:!0}),e.prototype.ngOnDestroy=function(){this.instanceCountDecr()},Object.defineProperty(e.prototype,"$CurrentPath",{get:function(){return this.clientFilesystem.$currentPath},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"$SelectedFile",{get:function(){return this.clientFilesystem.$selectedFile},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"$FilesWithIcons",{get:function(){return this.clientFilesystem.$FilesWithIcons},enumerable:!1,configurable:!0}),e.prototype.initialize=function(e,t){var n=this;this.logger.info("initializing...",{serverFilesystem:e,clientFilesystem:t}),this.serverFilesystem=e,this.clientFilesystem=t,this.destroyed.next(),this.refreshEmitter.pipe(i.takeUntil(this.destroyed),i.auditTime(800),i.tap((function(e){return _(n,void 0,void 0,(function(){return N(this,(function(t){return[2,this.clientFilesystem.OnList(e)]}))}))}))).subscribe((function(e){return _(n,void 0,void 0,(function(){return N(this,(function(t){return[2,this.updateListFromServer(e)]}))}))}))},e.prototype.reportError=function(e,t,n){this.logger.error("optimistic-filesystem:",{error:e,title:n,msg:t}),this.notifications.notify(e.message,n)},e.prototype.updateListFromServer=function(e){return _(this,void 0,void 0,(function(){var t,n;return N(this,(function(o){switch(o.label){case 0:return o.trys.push([0,6,,7]),this.status.UpdateStatus(e,"SENDING"),this.logger.info("updateListFromServer",{directoryPath:e}),[4,this.serverFilesystem.List(e)];case 1:return t=o.sent(),[4,this.clientFilesystem.UpdateList(t,e)];case 2:return o.sent(),[4,this.$CurrentPath.pipe(i.take(1)).toPromise()];case 3:return o.sent()!==e?[3,5]:[4,Promise.all([this.clientFilesystem.OnList(e),this.selectFirstInCurrentDirectory()])];case 4:o.sent(),o.label=5;case 5:return this.status.UpdateStatus(e,"SUCCESS"),[3,7];case 6:return n=o.sent(),this.reportError(n,"Cannot get directory list","List Error"),this.status.UpdateStatus(e,"FAILED",n),[3,7];case 7:return[2]}}))}))},e.prototype.HandleList=function(e){return _(this,void 0,void 0,(function(){return N(this,(function(t){return this.refreshEmitter.next(e),[2]}))}))},e.prototype.HandleCreateFolder=function(e,t){return _(this,void 0,void 0,(function(){var n;return N(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,4]),this.status.UpdateStatus(e,"SENDING"),this.logger.info("HandleCreateFolder",{newPath:e}),[4,Promise.all([this.clientFilesystem.OnCreateFolder(e,t),this.serverFilesystem.CreateFolder(e,t)])];case 1:return o.sent(),this.status.UpdateStatus(e,"SUCCESS"),[3,4];case 2:return n=o.sent(),this.reportError(n,"Cannot create folder","Create Folder Error"),this.status.UpdateStatus(e,"FAILED",n),[4,this.clientFilesystem.OnRemove([e])];case 3:return o.sent(),[3,4];case 4:return[2]}}))}))},e.prototype.HandleUpload=function(e){return _(this,void 0,void 0,(function(){var t,n,o=this;return N(this,(function(r){switch(r.label){case 0:return this.status.UpdateStatus("HandleUpload","SENDING"),this.logger.info("HandleUpload",{uploadedFiles:e}),t=e.map((function(e){return o.serverFilesystem.Upload(e)})),n={others:"read/write",readers:[],writers:[]},[4,Promise.all([this.serverFilesystem.SetPermissionsObjectMultiple(e,n,!0),this.clientFilesystem.OnUploadedFiles(e),t])];case 1:return r.sent(),this.status.UpdateStatus("HandleUpload","SUCCESS"),[2]}}))}))},e.prototype.HandleCopy=function(e,t){return _(this,void 0,void 0,(function(){var n;return N(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),this.status.UpdateStatus("HandleCopy"+e,"SENDING"),this.logger.info("HandleCopy",{singleFileName:e,newPath:t}),[4,Promise.all([this.clientFilesystem.OnCopy(e,t),this.serverFilesystem.Copy(e,t)])];case 1:return o.sent(),this.status.UpdateStatus("HandleCopy"+e,"SUCCESS"),[3,3];case 2:return n=o.sent(),this.reportError(n,"Cannot copy item","Copy Error"),this.status.UpdateStatus("HandleCopy"+e,"FAILED",n),[2,this.clientFilesystem.OnRemove([t])];case 3:return[2]}}))}))},e.prototype.HandleMove=function(e,t){return _(this,void 0,void 0,(function(){var n;return N(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),this.status.UpdateStatus("HandleMove"+e,"SENDING"),this.logger.info("HandleMove",{item:e,newPath:t}),[4,Promise.all([this.clientFilesystem.OnMove(e,t),this.serverFilesystem.Move(e,t)])];case 1:return o.sent(),this.status.UpdateStatus("HandleMove"+e,"SUCCESS"),[3,3];case 2:return n=o.sent(),this.reportError(n,"Cannot move item","Move Error"),this.status.UpdateStatus("HandleMove"+e,"FAILED"),[2,this.clientFilesystem.OnRemove([t])];case 3:return[2]}}))}))},e.prototype.HandleRename=function(e,t){return _(this,void 0,void 0,(function(){var n;return N(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),this.status.UpdateStatus("HandleRename"+e,"SENDING"),this.logger.info("HandleRename",{item:e,newItemPath:t}),[4,Promise.all([this.clientFilesystem.OnRename(e,t),this.serverFilesystem.Rename(e,t)])];case 1:return o.sent(),this.status.UpdateStatus("HandleRename"+e,"SUCCESS"),[3,3];case 2:return n=o.sent(),this.reportError(n,"Cannot rename item","Rename Error"),this.status.UpdateStatus("HandleRename"+e,"FAILED"),[2,this.clientFilesystem.OnRename(t,e)];case 3:return[2]}}))}))},e.prototype.HandleEdit=function(e,t){return _(this,void 0,void 0,(function(){var n;return N(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),this.status.UpdateStatus("HandleEdit"+e,"SENDING"),this.logger.info("HandleEdit",{item:e,content:t}),[4,Promise.all([this.clientFilesystem.OnEdit(e,t),this.serverFilesystem.Edit(e,t)])];case 1:return o.sent(),this.status.UpdateStatus("HandleEdit"+e,"SUCCESS"),[3,3];case 2:return n=o.sent(),this.reportError(n,"Cannot edit item","Edit Error"),this.status.UpdateStatus("HandleEdit"+e,"FAILED"),[3,3];case 3:return[2]}}))}))},e.prototype.HandleGetcontent=function(e){return _(this,void 0,void 0,(function(){var t,n;return N(this,(function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),this.status.UpdateStatus("HandleGetcontent"+e,"SENDING"),this.logger.info("HandleGetcontent",{item:e}),[4,this.clientFilesystem.OnGetcontent(e)];case 1:return o.sent(),[4,this.serverFilesystem.Getcontent(e)];case 2:return t=o.sent(),this.status.UpdateStatus("HandleGetcontent"+e,"SUCCESS"),[2,t.result];case 3:return n=o.sent(),this.reportError(n,"Cannot get item","Get Content Error"),this.status.UpdateStatus("HandleGetcontent"+e,"FAILED"),[3,4];case 4:return[2]}}))}))},e.prototype.HandleSetPermissions=function(e,t,n,o){return _(this,void 0,void 0,(function(){var r;return N(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),this.status.UpdateStatus("HandleSetPermissions"+e,"SENDING"),this.logger.info("HandleSetPermissions",{item:e,role:t,entity:n,recursive:o}),[4,Promise.all([this.clientFilesystem.OnSetPermissions(e,t,n,o),this.serverFilesystem.SetPermissions(e,t,n,o)])];case 1:return i.sent(),this.status.UpdateStatus("HandleSetPermissions"+e,"SUCCESS"),[3,3];case 2:return r=i.sent(),this.reportError(r,"Cannot set permissions to item","Permissions Error"),this.status.UpdateStatus("HandleSetPermissions"+e,"FAILED"),[3,3];case 3:return[2]}}))}))},e.prototype.HandleMoveMultiple=function(e,t){return _(this,void 0,void 0,(function(){var n;return N(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),this.status.UpdateStatus("HandleMoveMultiple"+e,"SENDING"),this.logger.info("HandleMoveMultiple",{items:e,newPath:t}),[4,Promise.all([this.clientFilesystem.OnMoveMultiple(e,t),this.serverFilesystem.MoveMultiple(e,t)])];case 1:return o.sent(),this.status.UpdateStatus("HandleMoveMultiple"+e,"SUCCESS"),[3,3];case 2:return n=o.sent(),this.reportError(n,"Cannot move items","Move Error"),this.status.UpdateStatus("HandleMoveMultiple"+e,"FAILED"),[3,3];case 3:return[2]}}))}))},e.prototype.HandleCopyMultiple=function(e,t){return _(this,void 0,void 0,(function(){var n;return N(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),this.status.UpdateStatus("HandleCopyMultiple"+e,"SENDING"),this.logger.info("HandleCopyMultiple",{items:e,newPath:t}),[4,Promise.all([this.clientFilesystem.OnCopyMultiple(e,t),this.serverFilesystem.CopyMultiple(e,t)])];case 1:return o.sent(),this.status.UpdateStatus("HandleCopyMultiple"+e,"SUCCESS"),[3,3];case 2:return n=o.sent(),this.reportError(n,"Cannot copy items","Copy Error"),this.status.UpdateStatus("HandleCopyMultiple"+e,"FAILED"),[3,3];case 3:return[2]}}))}))},e.prototype.HandleSetPermissionsMultiple=function(e,t,n,o){return _(this,void 0,void 0,(function(){var r;return N(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),this.status.UpdateStatus("HandleSetPermissionsMultiple"+e,"SENDING"),this.logger.info("HandleSetPermissionsMultiple",{items:e,role:t,entity:n,recursive:o}),[4,Promise.all([this.clientFilesystem.OnSetPermissionsMultiple(e,t,n,o),this.serverFilesystem.SetPermissionsMultiple(e,t,n,o)])];case 1:return i.sent(),this.status.UpdateStatus("HandleSetPermissionsMultiple"+e,"SUCCESS"),[3,3];case 2:return r=i.sent(),this.reportError(r,"Cannot set permissions to items","Permissions Error"),this.status.UpdateStatus("HandleSetPermissionsMultiple"+e,"FAILED"),[3,3];case 3:return[2]}}))}))},e.prototype.HandleSetPermissionsObjectMultiple=function(e,t,n){return _(this,void 0,void 0,(function(){var o;return N(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),this.status.UpdateStatus("HandleSetPermissionsObjectMultiple"+e,"SENDING"),this.logger.info("HandleSetPermissionsMultiple",{items:e,permissionsObj:t,recursive:n}),[4,Promise.all([this.clientFilesystem.OnSetPermissionsObjectMultiple(e,t,n),this.serverFilesystem.SetPermissionsObjectMultiple(e,t,n)])];case 1:return r.sent(),this.status.UpdateStatus("HandleSetPermissionsObjectMultiple"+e,"SUCCESS"),[3,3];case 2:return o=r.sent(),this.reportError(o,"Cannot set permissions to items","Permissions Error"),this.status.UpdateStatus("HandleSetPermissionsObjectMultiple"+e,"FAILED"),[3,3];case 3:return[2]}}))}))},e.prototype.HandleRemove=function(e){return _(this,void 0,void 0,(function(){var t;return N(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),this.status.UpdateStatus("HandleRemove"+e,"SENDING"),this.logger.info("HandleRemove",{items:e}),[4,Promise.all([this.clientFilesystem.OnRemove(e),this.serverFilesystem.Remove(e)])];case 1:return n.sent(),this.status.UpdateStatus("HandleRemove"+e,"SUCCESS"),[3,3];case 2:return t=n.sent(),this.reportError(t,"Cannot remove items","Remove Error"),this.status.UpdateStatus("HandleRemove"+e,"FAILED"),[3,3];case 3:return[2]}}))}))},e.prototype.HandleNavigateUp=function(){return _(this,void 0,void 0,(function(){var e,t,n,o;return N(this,(function(r){switch(r.label){case 0:e=c.v4(),r.label=1;case 1:return r.trys.push([1,4,,5]),this.status.UpdateStatus("HandleNavigateUp"+e,"SENDING"),this.logger.info("HandleNavigateUp"),[4,this.$CurrentPath.pipe(i.take(1)).toPromise()];case 2:return t=r.sent(),n=H.dirname(t),[4,this.HandleList(n)];case 3:return r.sent(),this.status.UpdateStatus("HandleNavigateUp"+e,"SUCCESS"),[3,5];case 4:throw o=r.sent(),this.reportError(o,"Cannot navigate to parent directory","Navigate Error"),this.status.UpdateStatus("HandleNavigateUp"+e,"FAILED"),new Error(o.message);case 5:return[2]}}))}))},e.prototype.onSelectItem=function(e){return _(this,void 0,void 0,(function(){return N(this,(function(t){return this.clientFilesystem.onSelectItem(e),[2]}))}))},e.prototype.GetItemByName=function(e){return this.clientFilesystem.CurrentFiles().find((function(t){return t.fullPath===e}))},e.prototype.onSelectItemByName=function(e){var t=this.GetItemByName(e);this.clientFilesystem.onSelectItem(t)},e.prototype.selectFirstInCurrentDirectory=function(){return _(this,void 0,void 0,(function(){var e,t;return N(this,(function(n){return e=this.clientFilesystem.CurrentFiles(),t=B(e).shift(),this.clientFilesystem.onSelectItem(t),[2]}))}))},e.prototype.CloneProvider=function(){var t=new e(this.logger,this.notifications,this.status);return t.initialize(this.serverFilesystem.CloneProvider(),this.clientFilesystem.CloneProvider()),t},e}();be.instanceCount=0,be.decorators=[{type:t.Injectable}],be.ctorParameters=function(){return[{type:G},{type:ne},{type:ge}]};var ye=function(){function e(e){this.dialogRef=e}return e.prototype.onSubmit=function(){this.dialogRef.close(!0)},e.prototype.onCancel=function(){this.dialogRef.close(!1)},e}();function ve(e){return{name:a.basename(e),fullPath:e,rightsFirebase:[],permissions:{others:"read/write",readers:["Example Reader"],writers:["Example Writer","Managers"]},size:"111",date:(new Date).toISOString(),type:e.endsWith("/")?"dir":"file"}}function we(e){return ve(J(e))}function xe(e){return ve(Q(e))}ye.decorators=[{type:t.Component,args:[{template:'\n    <base-dialog\n      [header]="headerTemplate"\n      [body]="bodyTemplate"\n      [actions]="actionsTemplate"\n    >\n      <ng-template #headerTemplate>\n        <h2>Set Permissions</h2>\n      </ng-template>\n      <ng-template #bodyTemplate>\n        <div>\n          <p>Would you like to set permissions for this folder?</p>\n        </div>\n      </ng-template>\n      <ng-template #actionsTemplate>\n        <btns-cancel-ok\n          okIcon="done"\n          okLabel="Yes"\n          (clickedCancel)="onCancel()"\n          (clickedOk)="onSubmit()"\n        >\n        </btns-cancel-ok>\n      </ng-template>\n    </base-dialog>\n  ',styles:["h1,h2,h3,h4,h5,h6,i,mat-chip,p,small,span{font-family:sans-serif}.is-red{background:red}.flex-col{display:flex;flex-direction:column}.flex-row{display:flex;flex-direction:row}.align-center{align-items:center}.align-top{align-items:start}.align-bottom{align-items:end}.fit-content{width:-moz-fit-content;width:fit-content}.sans-serif{font-family:sans-serif}.has-pointer{cursor:pointer}.has-ellipsis{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.scroll-x{overflow-x:auto}.full-width{width:100%}.text-center{text-align:center}.space-between{justify-content:space-between}.break-word{overflow-wrap:break-word;word-break:break-all}.capitalize{text-transform:capitalize}.p5{padding:5px}.m0{margin:0}.mb-10{margin-bottom:10px}.mr-10{margin-right:10px}.m-10{margin:10px}.color-grey{color:#8c8c8c}.rounded{border-radius:5px}.bg-grey-light{background-color:rgba(95,95,95,.2)}.bg-grey-dark{background-color:rgba(50,50,50,.39)}.bg-grey-hover{transition:background-color .5s}.bg-grey-hover:hover{background-color:rgba(95,95,95,.336)}.color-white{color:#fff}.color-grey-hover{transition:color .5s}.color-grey-hover:hover{color:#444}.color-black{color:#000}.action-toolbar{height:55px}.top-toolbar-label{font-size:.8em;margin:0}.top-toolbar{height:20px;padding-top:3px}"]}]}],ye.ctorParameters=function(){return[{type:l.MatDialogRef}]};var ke=[we("/image1.png"),we("/image2.jpeg"),we("/subfile.txt"),we("/subfile.mp3"),we("/subfile.mp4"),we("/tables.csv"),we("/time.docx"),xe("/emptyFolder/"),xe("/subfolder/"),we("/subfolder/file.txt"),we("/subfolder/file.png"),xe("/subfolder/xsub1/"),xe("/subfolder/ysub1/"),xe("/subfolder/2sub1/"),xe("/subfolder/1sub1/"),xe("/subfolder/sub1/"),we("/subfolder/sub1/file.txt"),xe("/subfolder/sub1/sub1/"),we("/subfolder/sub1/sub11/file.txt"),xe("/subfolder/sub1/sub11/sub111/"),we("/subfolder/sub1/sub11/sub111/file.txt"),xe("/subfolder/sub1/sub12/"),we("/subfolder/sub1/sub12/file.txt"),xe("/subfolder/sub1/sub12/sub112/"),we("/subfolder/sub1/sub12/sub112/file.txt"),xe("/subfolder/sub2/"),we("/subfolder/sub2/file.txt"),xe("/subfolder/sub2/sub21/"),we("/subfolder/sub2/sub21/file.txt"),xe("/subfolder/sub2/sub21/sub211/"),we("/subfolder/sub2/sub21/sub211/file.txt"),xe("/subfolder/sub2/sub22/"),we("/subfolder/sub2/sub22/file.txt"),xe("/subfolder/sub2/sub22/sub221/"),we("/subfolder/sub2/sub22/sub221/file.txt")],Ce=function(){function e(e,t,n,o,r){this.clientFilesystem=e,this.optimisticFs=t,this.dialog=n,this.logger=o,this.notifications=r}return Object.defineProperty(e.prototype,"$CurrentPath",{get:function(){return this.optimisticFs.$CurrentPath},enumerable:!1,configurable:!0}),e.prototype.GetCurrentPath=function(){return _(this,void 0,void 0,(function(){return N(this,(function(e){switch(e.label){case 0:return[4,this.$CurrentPath.pipe(i.take(1)).toPromise()];case 1:return[2,e.sent()||""]}}))}))},e.prototype.ConvertToRelativePath=function(e){var t=(this.config.virtualRoot||"").length;return(e||"").slice(t)},e.prototype.GetRootPath=function(){return this.config.virtualRoot||""},Object.defineProperty(e.prototype,"$CurrentPathIsRoot",{get:function(){var e=this;return this.$CurrentPath.pipe(i.map((function(t){return t===e.config.virtualRoot})))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"$SelectedFile",{get:function(){return this.optimisticFs.$SelectedFile},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"$FilesWithIcons",{get:function(){return this.optimisticFs.$FilesWithIcons},enumerable:!1,configurable:!0}),e.prototype.init=function(e,t){return _(this,void 0,void 0,(function(){var n;return N(this,(function(o){switch(o.label){case 0:this.config=t,this.fileSystem=e,this.logger.info("init()",{fileSystem:e,config:t}),this.optimisticFs.initialize(this.fileSystem,this.clientFilesystem),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,this.clientFilesystem.OnList(t.initialPath)];case 2:return o.sent(),[3,4];case 3:return n=o.sent(),this.logger.error("init() OnNewFolderClobber: error",n,{fileSystem:e,config:t}),[3,4];case 4:return[2]}}))}))},e.prototype.OnRename=function(e){return _(this,void 0,void 0,(function(){var t,n,o,r=this;return N(this,(function(i){switch(i.label){case 0:return t={currentPath:e.fullPath},this.logger.info("OnRename",{data:t}),[4,this.openDialog(q,t)];case 1:if(!(n=i.sent()))return this.notifications.notifyCancelled(),[2];i.label=2;case 2:return i.trys.push([2,5,,6]),[4,this.optimisticFs.HandleRename(e.fullPath,n)];case 3:return i.sent(),[4,this.RefreshExplorer()];case 4:return i.sent(),setTimeout((function(){r.optimisticFs.onSelectItemByName(n)}),300),[3,6];case 5:return o=i.sent(),this.logger.error("OnRename",{error:o}),this.notifications.notify(o.message,"Rename Error"),[3,6];case 6:return[2]}}))}))},e.prototype.OnMoveMultiple=function(e){return _(this,void 0,void 0,(function(){var t,n,o,r;return N(this,(function(i){switch(i.label){case 0:return t={files:e,isCopy:!1,actionHandler:this},[4,this.openDialog(ee,t)];case 1:if(!(n=i.sent()))return this.notifications.notifyCancelled(),[2];i.label=2;case 2:return i.trys.push([2,5,,6]),o=e.map((function(e){return e.fullPath})),[4,this.optimisticFs.HandleMoveMultiple(o,n)];case 3:return i.sent(),[4,this.RefreshExplorer()];case 4:return i.sent(),[3,6];case 5:return r=i.sent(),this.logger.error("OnMoveMultiple",{error:r}),this.notifications.notify(r.message,"Move Error"),[3,6];case 6:return[2]}}))}))},e.prototype.OnCopyMultiple=function(e){return _(this,void 0,void 0,(function(){var t,n,o,r;return N(this,(function(i){switch(i.label){case 0:return t={files:e,isCopy:!0,actionHandler:this},[4,this.openDialog(ee,t)];case 1:if(n=i.sent(),this.logger.info("OnCopyMultiple",{files:e,newFolderPath:n}),!n)return this.notifications.notifyCancelled(),[2];i.label=2;case 2:return i.trys.push([2,5,,6]),o=e.map((function(e){return e.fullPath})),[4,this.optimisticFs.HandleCopyMultiple(o,n)];case 3:return i.sent(),[4,this.RefreshExplorer()];case 4:return i.sent(),[3,6];case 5:return r=i.sent(),this.logger.error("OnCopyMultiple",{error:r}),this.notifications.notify(r.message,"Copy Error"),[3,6];case 6:return[2]}}))}))},e.prototype.checkCanAddPermissions=function(){if(!this.config.users)throw new Error('The "config.users" property was not defined');if(!this.config.groups)throw new Error('The "config.groups" property was not defined')},e.prototype.OnSetPermissionsMultiple=function(e){return _(this,void 0,void 0,(function(){return N(this,(function(t){return[2,this.OnSetPermissionsObjectMultiple(e)]}))}))},e.prototype.OnSetPermissionsObjectMultiple=function(e){return _(this,void 0,void 0,(function(){var t,n,o,r;return N(this,(function(i){switch(i.label){case 0:t={files:e,config:this.config};try{this.checkCanAddPermissions()}catch(e){return this.notifications.notify(e.message,"Permissions Error"),[2]}return[4,this.openDialog(te,t)];case 1:if(!(n=i.sent()))return this.notifications.notifyCancelled(),[2];i.label=2;case 2:return i.trys.push([2,5,,6]),o=e.map((function(e){return e.fullPath})),[4,this.optimisticFs.HandleSetPermissionsObjectMultiple(o,n.permissionsObj,!0)];case 3:return i.sent(),[4,this.RefreshExplorer()];case 4:return i.sent(),[3,6];case 5:return r=i.sent(),this.logger.error("OnSetPermissionsMultiple",{error:r}),this.notifications.notify(r.message,"Permissions Error"),[3,6];case 6:return[2]}}))}))},e.prototype.OnDeleteMultiple=function(e){return _(this,void 0,void 0,(function(){var t,n;return N(this,(function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),t=e.map((function(e){return e.fullPath})),this.logger.info("deleting files",{files:e,deletedPaths:t}),[4,this.optimisticFs.HandleRemove(t)];case 1:return o.sent(),[4,this.RefreshExplorer()];case 2:return o.sent(),[3,4];case 3:return n=o.sent(),this.logger.error("OnDeleteMultiple",{error:n}),this.notifications.notify(n.message,"Deletion Error"),[3,4];case 4:return[2]}}))}))},e.prototype.OnNavigateTo=function(e){return _(this,void 0,void 0,(function(){return N(this,(function(t){return this.logger.info("action-handlers.OnNavigateTo",{folderPath:e}),[2,this.optimisticFs.HandleList(e)]}))}))},e.prototype.OnNavigateToParent=function(){return _(this,void 0,void 0,(function(){return N(this,(function(e){switch(e.label){case 0:return this.logger.info("OnNavigateToParent"),[4,this.optimisticFs.HandleNavigateUp()];case 1:return e.sent(),[2]}}))}))},e.prototype.OnSelectItemByPath=function(e){return _(this,void 0,void 0,(function(){return N(this,(function(t){return this.optimisticFs.onSelectItemByName(e),[2]}))}))},e.prototype.OnUploadFilesToCurrentDirectory=function(){return _(this,void 0,void 0,(function(){var e,t,n,o;return N(this,(function(r){switch(r.label){case 0:return this.logger.info("onClickUpload"),[4,this.GetCurrentPath()];case 1:return e=r.sent(),t={currentDirectory:e,firebaseConfig:this.config.firebaseConfig,bucketName:this.config.bucketName},[4,this.openDialog(oe,t)];case 2:return(n=r.sent())?(o=n.uploaded.map((function(t){return H.join(e,t)})),[4,this.optimisticFs.HandleUpload(o)]):(this.logger.info("onClickUpload canceled..."),[2]);case 3:return r.sent(),[4,this.optimisticFs.HandleList(e)];case 4:return r.sent(),[2]}}))}))},e.prototype.OnNewFolderInCurrentDirectory=function(){return _(this,void 0,void 0,(function(){var e,t,n,o;return N(this,(function(r){switch(r.label){case 0:return this.logger.info("onClickNewFolder"),[4,this.openDialog(re)];case 1:return(e=r.sent())?[4,this.OnNewFolder(e)]:(this.logger.info("onClickNewFolder   no folder created..."),[2]);case 2:return r.sent(),[4,this.openDialog(ye)];case 3:return r.sent()?[4,this.GetCurrentPath()]:[3,6];case 4:return t=r.sent(),n=H.join(t,e),o=xe(n),[4,this.OnSetPermissionsMultiple([o])];case 5:r.sent(),r.label=6;case 6:return[2]}}))}))},e.prototype.OnNewFolder=function(e){return _(this,void 0,void 0,(function(){var t,n;return N(this,(function(o){switch(o.label){case 0:return[4,this.GetCurrentPath()];case 1:return t=o.sent(),n=H.join(t,e),[4,this.optimisticFs.HandleCreateFolder(n)];case 2:return o.sent(),[4,this.optimisticFs.HandleList(t)];case 3:return o.sent(),[2]}}))}))},e.prototype.OnNewFolderClobber=function(e){return _(this,void 0,void 0,(function(){var t,n;return N(this,(function(o){switch(o.label){case 0:return"/"===e?[2]:[4,this.GetCurrentPath()];case 1:return t=o.sent(),n=H.join(t,e),[4,this.optimisticFs.HandleCreateFolder(n,!0)];case 2:return o.sent(),[4,this.optimisticFs.HandleList(t)];case 3:return o.sent(),[2]}}))}))},e.prototype.OnDownloadFile=function(e){return _(this,void 0,void 0,(function(){var t,n,o;return N(this,(function(r){switch(r.label){case 0:return[4,this.fileSystem.GetSingle(e.fullPath)];case 1:return t=r.sent(),n=t.result.file,[4,this.optimisticFs.onSelectItem(n)];case 2:return r.sent(),this.initiateDownload(e.name,t.result.url),[4,this.GetCurrentPath()];case 3:return o=r.sent(),[4,this.optimisticFs.HandleList(o)];case 4:return r.sent(),[2]}}))}))},e.prototype.initiateDownload=function(e,t){this.logger.info("initiateDownload...",{url:t});var n=document.createElement("a");n.download=e,n.target="_blank",n.href=t,n.click()},e.prototype.RefreshExplorer=function(){return _(this,void 0,void 0,(function(){var e;return N(this,(function(t){switch(t.label){case 0:return[4,this.GetCurrentPath()];case 1:return e=t.sent(),[2,this.optimisticFs.HandleList(e)]}}))}))},e.prototype.openDialog=function(e,t){return _(this,void 0,void 0,(function(){return N(this,(function(n){switch(n.label){case 0:return[4,this.dialog.open(e,{width:"600px",hasBackdrop:!0,disableClose:!1,data:t}).afterClosed().pipe(i.take(1)).toPromise()];case 1:return[2,n.sent()]}}))}))},e.prototype.CloneProvider=function(){return _(this,void 0,void 0,(function(){var t;return N(this,(function(n){switch(n.label){case 0:return[4,(t=new e(this.clientFilesystem.CloneProvider(),this.optimisticFs.CloneProvider(),this.dialog,this.logger,this.notifications)).init(this.fileSystem,this.config)];case 1:return n.sent(),[2,t]}}))}))},e.prototype.ListCurrentPathItems=function(e){return this.fileSystem.List(e)},e}();function Se(e,t){return function(n,o){var r=(n[e]+"").toLowerCase(),i=(o[e]+"").toLowerCase();return r<i?"desc"===t?1:-1:r>i?"desc"===t?-1:1:0}}Ce.decorators=[{type:t.Injectable}],Ce.ctorParameters=function(){return[{type:me},{type:be},{type:l.MatDialog},{type:G},{type:ne}]};var Pe=function(){function e(e,t,n){this.actionHandlers=e,this.logger=t,this.status=n,this.isFileDetailsOpen=!0,this.$BulkSelected=new s.BehaviorSubject([]),this.$triggerClearSelected=new s.Subject,this.destroyed=new s.Subject,this.enableSearch=!1,this.searchKeyword="",this.seachResultDocuments=[],this.seachResultFolders=[],this.documentsShow=10,this.foldersShow=10,this.isSearching=!1,this.showSearchingSpinner=!1,this.requestMap=this.status.ActiveRequestsMap,this.searchForm=new o.FormGroup({searchKeyword:new o.FormControl("",[o.Validators.minLength(3)])})}return Object.defineProperty(e.prototype,"$status",{get:function(){return this.status.ActiveRequestsMap.pipe(i.map((function(e){return Object.keys(e).map((function(t){return e[t].status}))})))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"$hasSending",{get:function(){return this.$status.pipe(i.map((function(e){return!!e.find((function(e){return"SENDING"===e}))})))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"$hasFailed",{get:function(){return this.$status.pipe(i.map((function(e){return!!e.find((function(e){return"FAILED"===e}))})))},enumerable:!1,configurable:!0}),e.prototype.ngOnInit=function(){return _(this,void 0,void 0,(function(){var e=this;return N(this,(function(t){switch(t.label){case 0:if(!this.fileSystem)throw new Error("<ngx-filemanager> must have input selector [fileSystem] set");if(!this.config)throw new Error("<ngx-filemanager> must have input selector [config] set");return this.config.virtualRoot||(console.warn('<ngx-filemanager> warning config.virtualRoot not set, using bucket root "/"'),this.config.virtualRoot="/"),this.config.virtualRoot.endsWith("/")&&(this.config.virtualRoot=this.config.virtualRoot.slice(0,-1)),this.config.initialPath||(console.warn("<ngx-filemanager> warning config.initialPath not set, using virtualRoot: "+this.config.virtualRoot),this.config.initialPath=this.config.virtualRoot),[4,this.actionHandlers.init(this.fileSystem,this.config)];case 1:return t.sent(),[4,this.actionHandlers.OnNavigateTo(this.config.virtualRoot)];case 2:return t.sent(),this.$CurrentPath=this.actionHandlers.$CurrentPath,this.actionHandlers.$SelectedFile.pipe(i.takeUntil(this.destroyed),i.tap((function(t){console.log("this.$SelectedFile.pipe",{selectedFile:t}),e.SelectedFile=null,setTimeout((function(){e.SelectedFile=t}))}))).subscribe(),this.makeConfig(),this.initLoaded=!0,this.enableSearch=!!this.config.enableSearch||!1,[2]}}))}))},e.prototype.ngOnDestroy=function(){this.destroyed.next()},e.prototype.makeConfig=function(){var e=this;this.fileActions=[{label:"Download",icon:"file_download",onClick:function(t){return _(e,void 0,void 0,(function(){return N(this,(function(e){return[2,this.actionHandlers.OnDownloadFile(t)]}))}))}},{label:"Copy",icon:"content_copy",onClick:function(t){return _(e,void 0,void 0,(function(){return N(this,(function(e){return[2,this.actionHandlers.OnCopyMultiple([t])]}))}))}},{label:"Move",icon:"forward",onClick:function(t){return _(e,void 0,void 0,(function(){return N(this,(function(e){return[2,this.actionHandlers.OnMoveMultiple([t])]}))}))}},{label:"Rename",icon:"border_color",onClick:function(t){return _(e,void 0,void 0,(function(){return N(this,(function(e){return[2,this.actionHandlers.OnRename(t)]}))}))}},{label:"Permissions",icon:"lock_outline",onClick:function(t){return _(e,void 0,void 0,(function(){return N(this,(function(e){return[2,this.actionHandlers.OnSetPermissionsMultiple([t])]}))}))}},{label:"Delete",icon:"delete",color:"warn",onClick:function(t){return _(e,void 0,void 0,(function(){return N(this,(function(e){return[2,this.actionHandlers.OnDeleteMultiple([t])]}))}))}}],this.folderActions=[{label:"Copy",icon:"content_copy",onClick:function(t){return _(e,void 0,void 0,(function(){return N(this,(function(e){return[2,this.actionHandlers.OnCopyMultiple([t])]}))}))}},{label:"Move",icon:"forward",onClick:function(t){return _(e,void 0,void 0,(function(){return N(this,(function(e){return[2,this.actionHandlers.OnMoveMultiple([t])]}))}))}},{label:"Rename",icon:"border_color",onClick:function(t){return _(e,void 0,void 0,(function(){return N(this,(function(e){return[2,this.actionHandlers.OnRename(t)]}))}))}},{label:"Permissions",icon:"lock_outline",onClick:function(t){return _(e,void 0,void 0,(function(){return N(this,(function(e){return[2,this.actionHandlers.OnSetPermissionsMultiple([t])]}))}))}},{label:"Delete",icon:"delete",color:"warn",onClick:function(t){return _(e,void 0,void 0,(function(){return N(this,(function(e){return[2,this.actionHandlers.OnDeleteMultiple([t])]}))}))}}],this.bulkActions=[{label:"Cancel",icon:"clear",onClick:function(t){return _(e,void 0,void 0,(function(){return N(this,(function(e){return[2,this.ClearBulkSelected()]}))}))}},{label:"Copy",icon:"content_copy",onClick:function(t){return e.actionHandlers.OnCopyMultiple(B(t))}},{label:"Move",icon:"forward",onClick:function(t){return e.actionHandlers.OnMoveMultiple(t)}},{label:"Set Permissions",icon:"lock_outline",onClick:function(t){return e.actionHandlers.OnSetPermissionsObjectMultiple(t)},$disabled:s.of(!this.config.isAdmin)},{label:"Delete",icon:"delete",color:"warn",onClick:function(t){return e.actionHandlers.OnDeleteMultiple(t)},$disabled:s.of(!this.config.isAdmin)}],this.mainActions=[{label:"Back Folder",icon:"reply",onClick:function(){return _(e,void 0,void 0,(function(){return N(this,(function(e){return[2,this.actionHandlers.OnNavigateToParent()]}))}))},$disabled:this.actionHandlers.$CurrentPathIsRoot},{label:"Refresh",icon:"refresh",onClick:function(){return _(e,void 0,void 0,(function(){return N(this,(function(e){return[2,this.actionHandlers.RefreshExplorer()]}))}))}},{label:"Upload Files",icon:"file_upload",onClick:function(){return _(e,void 0,void 0,(function(){return N(this,(function(e){return[2,this.actionHandlers.OnUploadFilesToCurrentDirectory()]}))}))}},{label:"New Folder",icon:"create_new_folder",onClick:function(){return _(e,void 0,void 0,(function(){return N(this,(function(e){return[2,this.actionHandlers.OnNewFolderInCurrentDirectory()]}))}))}}],this.fileDetailActions=[{label:"Download",toolTip:"Click to Download",icon:"file_download",$disabled:this.actionHandlers.$SelectedFile.pipe(i.map((function(e){return!e||"file"!==e.type}))),onClick:function(t){return _(e,void 0,void 0,(function(){return N(this,(function(e){return[2,this.actionHandlers.OnDownloadFile(t)]}))}))}},{label:"Rename",toolTip:"Click to Rename",icon:"border_color",$disabled:s.of(!this.config.isAdmin),onClick:function(t){return _(e,void 0,void 0,(function(){return N(this,(function(e){return[2,this.actionHandlers.OnRename(t)]}))}))}},{label:"Set Permissions",toolTip:"Click to Set Permissions",icon:"lock_outline",$disabled:s.of(!this.config.isAdmin),onClick:function(t){return _(e,void 0,void 0,(function(){return N(this,(function(e){return[2,this.actionHandlers.OnSetPermissionsObjectMultiple([t])]}))}))}},{label:"Delete",toolTip:"Click to Delete",icon:"delete",$disabled:s.of(!this.config.isAdmin),color:"warn",onClick:function(t){return _(e,void 0,void 0,(function(){return N(this,(function(e){return[2,this.actionHandlers.OnDeleteMultiple([t])]}))}))}}];var t=new s.BehaviorSubject([]);this.actionHandlers.$FilesWithIcons.subscribe((function(e){return t.next(e)})),this.folders$=t.pipe(i.tap((function(e){return console.log("folders",{folders:e})})),i.map((function(e){return e.filter((function(e){return"dir"===e.type})).sort(Se("name","asc"))}))),this.files$=t.pipe(i.tap((function(e){return console.log("files",{files:e})})),i.map((function(e){return e.filter((function(e){return"file"===e.type})).sort(Se("name","asc"))})))},e.prototype.onEnterFolder=function(e){return _(this,void 0,void 0,(function(){return N(this,(function(t){return this.logger.info("onSelectItemDoubleClick!",{itemPath:e}),this.ClearBulkSelected(),[2,this.actionHandlers.OnNavigateTo(e)]}))}))},e.prototype.onSelectedFilePath=function(e){return _(this,void 0,void 0,(function(){return N(this,(function(t){return this.logger.info("onSelectItem!",{itemPath:e}),[2,this.actionHandlers.OnSelectItemByPath(e)]}))}))},e.prototype.onDetailsClickDelete=function(e){return _(this,void 0,void 0,(function(){return N(this,(function(t){switch(t.label){case 0:return[4,this.actionHandlers.OnDeleteMultiple([e])];case 1:return t.sent(),[2]}}))}))},e.prototype.onDetailsClickDownload=function(e){return _(this,void 0,void 0,(function(){return N(this,(function(t){switch(t.label){case 0:return[4,this.actionHandlers.OnDownloadFile(e)];case 1:return t.sent(),[2]}}))}))},e.prototype.onDetailsClickRename=function(e){return _(this,void 0,void 0,(function(){return N(this,(function(t){switch(t.label){case 0:return[4,this.actionHandlers.OnRename(e)];case 1:return t.sent(),[2]}}))}))},e.prototype.onDetailsClickSinglePermissions=function(e){return _(this,void 0,void 0,(function(){return N(this,(function(t){switch(t.label){case 0:return[4,this.actionHandlers.OnSetPermissionsMultiple([e])];case 1:return t.sent(),[4,this.actionHandlers.OnSelectItemByPath(e.fullPath)];case 2:return t.sent(),[2]}}))}))},e.prototype.onClickCrumb=function(e){return _(this,void 0,void 0,(function(){return N(this,(function(t){return this.ClearBulkSelected(),this.logger.info("onClickCrumb",{newPath:e}),[2,this.actionHandlers.OnNavigateTo(e)]}))}))},e.prototype.ClearBulkSelected=function(){this.$triggerClearSelected.next(),this.$BulkSelected.next([])},e.prototype.searchAllDocumentsAndFolders=function(e){return _(this,void 0,void 0,(function(){var t;return N(this,(function(n){switch(n.label){case 0:return e=e.toLocaleLowerCase().trim(),this.searchForm.valid?[4,this.initCleanSearchResults()]:[2];case 1:return n.sent(),t=this.actionHandlers.GetRootPath(),this.isSearching=!0,this.showSearchingSpinner=!0,this.iterateCurrentDocumentAndFolders(t,e,0),[2]}}))}))},e.prototype.iterateCurrentDocumentAndFolders=function(e,t,n){return _(this,void 0,void 0,(function(){var o=this;return N(this,(function(r){switch(r.label){case 0:return n>100&&(this.isSearching=!1),this.showSearchingSpinner&&(this.showSearchingSpinner=this.isSearching&&0===this.seachResultDocuments.length&&0===this.seachResultFolders.length&&n<3),this.isSearching?[4,this.actionHandlers.ListCurrentPathItems(e)]:[2];case 1:return r.sent().result.forEach((function(e){console.log(e,"item.type",e.type),"file"===e.type?o.checkSearchKeywordRelative(e.name,t)&&o.seachResultDocuments.push(e):"dir"===e.type&&(o.checkSearchKeywordRelative(e.name,t)&&o.seachResultFolders.push(e),o.iterateCurrentDocumentAndFolders(e.fullPath,t,n+1))})),[2]}}))}))},e.prototype.checkSearchKeywordRelative=function(e,t){return e.toLowerCase().includes(t)},e.prototype.initCleanSearchResults=function(){var e=this;return this.isSearching=!1,this.showSearchingSpinner=!1,new Promise((function(t){setTimeout((function(){e.seachResultDocuments=[],e.seachResultFolders=[],e.foldersShow=5,e.documentsShow=5,t()}),10)}))},e.prototype.onSelectedSearchItem=function(e){if("file"===e.type){var t=e.fullPath.substring(0,e.fullPath.lastIndexOf("/"));this.onEnterFolder(t)}else"dir"===e.type&&this.onEnterFolder(e.fullPath)},e}();function Fe(e){return{label:"",icon:"home",path:e,virtualPath:"/"}}function Ie(e){return{label:"",icon:"mood_bad",path:e,virtualPath:e}}Pe.decorators=[{type:t.Component,args:[{selector:"ngx-filemanager",template:'<div class="ngx-file-page-container">\n  <mat-drawer-container>\n    <mat-drawer-content [class.loaded]="initLoaded">\n      <div\n        class="bulk-actions-container"\n        [class.hidden]="($BulkSelected | async).length < 1"\n        *ngIf="initLoaded"\n      >\n        <bulk-actions\n          [bulkActions]="this.bulkActions"\n          [bulkSelected$]="this.$BulkSelected"\n          (clearSelected)="this.ClearBulkSelected()"\n        >\n        </bulk-actions>\n      </div>\n      <div class="folder-actions-container">\n        <main-actions [mainActions]="this.mainActions"> </main-actions>\n      </div>\n      <div class="flex-h space-between breadcrumb-container">\n        <bread-crumbs\n          [currentPath]="$CurrentPath | async"\n          (clickedCrumb)="this.onClickCrumb($event)"\n          [config]="config"\n        >\n        </bread-crumbs>\n        <div class="flex-h">\n          <mat-progress-spinner\n            *ngIf="$hasSending | async"\n            mode="indeterminate"\n            [diameter]="40"\n            color="primary"\n          ></mat-progress-spinner>\n          <mat-progress-spinner\n            *ngIf="$hasFailed | async"\n            mode="determinate"\n            [diameter]="40"\n            color="warn"\n            [value]="100"\n          ></mat-progress-spinner>\n          <div\n            class="mat-elevation-z8 expander-container has-pointer mat-table"\n            (click)="isFileDetailsOpen = !isFileDetailsOpen"\n          >\n            <mat-icon\n              matTooltip="View File Details"\n              class="expander-icon"\n              [class.drawer-out]="isFileDetailsOpen"\n              [class.drawer-in]="!isFileDetailsOpen"\n              >expand_more</mat-icon\n            >\n          </div>\n        </div>\n      </div>\n      <div *ngIf="enableSearch">\n        <form (submit)="searchAllDocumentsAndFolders(searchKeyword)" [formGroup]="searchForm">\n          <mat-form-field class="w-full px-2">\n            <input matInput [(ngModel)]="searchKeyword" formControlName="searchKeyword" placeholder="Search here"/>\n          </mat-form-field>\n          <mat-progress-spinner\n              *ngIf="showSearchingSpinner"\n              mode="determinate"\n              [diameter]="40"\n              color="warn"\n              [value]="100"\n            ></mat-progress-spinner>\n        </form>\n        <div *ngIf="!showSearchingSpinner&&isSearching&&seachResultDocuments.length===0&&seachResultFolders.length===0">\n          <div class="card-container">\n            <h4>Search results: </h4>\n            <mat-card >\n              <div class="document">\n                <div class="title">\n                  There are no site files/folders match your keyword.\n                </div>\n              </div>\n            </mat-card>\n          </div>\n        </div>\n        <div class="exp-panel" *ngIf="seachResultDocuments.length>0">\n          <mat-expansion-panel [expanded]="true">\n            <mat-expansion-panel-header>\n              <mat-panel-title>\n                Files:\n              </mat-panel-title>\n              <mat-panel-description>\n                They are results of search files.\n              </mat-panel-description>\n            </mat-expansion-panel-header>\n            <mat-card (click)="onSelectedSearchItem(document)" *ngFor="let document of seachResultDocuments|slice:0: documentsShow">\n              <div class="document">\n                <div class="title">\n                  {{document.name}}\n                </div>\n                <div class="search-item">\n                  <mat-icon class="icon-size-44 text-primary">\n                      insert_drive_file\n                  </mat-icon>\n                  <span>{{ document.fullPath }}</span>\n              </div>\n              </div>\n            </mat-card>\n            <div class="text-right">\n              <button \n                *ngIf="documentsShow < seachResultDocuments.length"\n                (click)="documentsShow=documentsShow+10"\n                mat-raised-button>Load more</button>\n              </div>\n          </mat-expansion-panel>\n        </div>\n        <div class="exp-panel" *ngIf="seachResultFolders.length>0">\n          <mat-expansion-panel [expanded]="true">\n            <mat-expansion-panel-header>\n              <mat-panel-title>\n                Folders:\n              </mat-panel-title>\n              <mat-panel-description>\n                They are results of search folders.\n              </mat-panel-description>\n            </mat-expansion-panel-header>\n            <mat-card (click)="onSelectedSearchItem(folder)" *ngFor="let folder of seachResultFolders|slice:0: foldersShow">\n              <div class="document">\n                <div class="title">\n                  {{folder.name}}\n                </div>\n                <div class="search-item">\n                  <mat-icon class="icon-size-44 text-primary">\n                      folder\n                  </mat-icon>\n                  <span>{{ folder.fullPath }}</span>\n                </div>\n              </div>\n            </mat-card>\n            <div class="text-right">\n              <button \n                *ngIf="foldersShow < seachResultFolders.length"\n                (click)="foldersShow=foldersShow+10"\n                mat-raised-button>Load more</button>\n            </div>\n          </mat-expansion-panel>\n        </div>\n      </div>\n      <app-file-table\n        *ngIf="folders$ && files$"\n        [folders]="folders$ | async"\n        [files]="files$ | async"\n        [fileActions]="fileActions"\n        [folderActions]="folderActions"\n        [config]="config"\n        [$triggerClearSelected]="$triggerClearSelected"\n        (checkedChanged)="$BulkSelected.next($event)"\n        (selectedChanged)="this.onSelectedFilePath($event)"\n        (enterFolder)="this.onEnterFolder($event)"\n      >\n      </app-file-table>\n    </mat-drawer-content>\n    <mat-drawer\n      #drawer\n      [(opened)]="isFileDetailsOpen"\n      class="history-drawer"\n      mode="side"\n      position="end"\n      opened\n    >\n      <ngx-filemanager-file-details\n        [actions]="fileDetailActions"\n        [file]="SelectedFile"\n        [fileSystem]="fileSystem"\n        [config]="config"\n        (clickedDownload)="this.onDetailsClickDownload($event)"\n      >\n      </ngx-filemanager-file-details>\n    </mat-drawer>\n  </mat-drawer-container>\n</div>\n',providers:[Ce,me,be],styles:[".heading{font-family:sans-serif;margin-left:10px}mat-drawer{width:260px}mat-drawer-content{overflow:hidden}mat-drawer-content .loaded{overflow:auto}mat-drawer-container{width:100%}.ngx-file-page-container{display:flex;height:calc(100% - 65px)}.expander-container{align-items:center;cursor:pointer;display:flex;flex-direction:row-reverse;right:0;top:0;z-index:1}.expander-icon{font-size:2em;height:1em;transition:transform .5s;width:1em}.bulk-actions-container{height:80px;overflow:hidden;position:absolute;top:0;transition:top .7s;width:100%;z-index:2}.hidden{top:-90px}.drawer-out{transform:rotate(-90deg)}.drawer-in{transform:rotate(90deg)}.flex-h{align-items:center;display:flex;flex-direction:row}.space-between{justify-content:space-between}button.top{margin-left:10px}.breadcrumb-container{margin:2px 0}.document{cursor:pointer}.search-item{align-items:center;display:flex}","h1,h2,h3,h4,h5,h6,i,mat-chip,p,small,span{font-family:sans-serif}.is-red{background:red}.flex-col{display:flex;flex-direction:column}.flex-row{display:flex;flex-direction:row}.align-center{align-items:center}.align-top{align-items:start}.align-bottom{align-items:end}.fit-content{width:-moz-fit-content;width:fit-content}.sans-serif{font-family:sans-serif}.has-pointer{cursor:pointer}.has-ellipsis{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.scroll-x{overflow-x:auto}.full-width{width:100%}.text-center{text-align:center}.space-between{justify-content:space-between}.break-word{overflow-wrap:break-word;word-break:break-all}.capitalize{text-transform:capitalize}.p5{padding:5px}.m0{margin:0}.mb-10{margin-bottom:10px}.mr-10{margin-right:10px}.m-10{margin:10px}.color-grey{color:#8c8c8c}.rounded{border-radius:5px}.bg-grey-light{background-color:rgba(95,95,95,.2)}.bg-grey-dark{background-color:rgba(50,50,50,.39)}.bg-grey-hover{transition:background-color .5s}.bg-grey-hover:hover{background-color:rgba(95,95,95,.336)}.color-white{color:#fff}.color-grey-hover{transition:color .5s}.color-grey-hover:hover{color:#444}.color-black{color:#000}.action-toolbar{height:55px}.top-toolbar-label{font-size:.8em;margin:0}.top-toolbar{height:20px;padding-top:3px}"]}]}],Pe.ctorParameters=function(){return[{type:Ce},{type:G},{type:ge}]},Pe.propDecorators={fileSystem:[{type:t.Input}],config:[{type:t.Input}]};var Oe=function(e,t){var n=Y(e),o=Y(t);if(0!==o.indexOf(n))return console.warn("Absolute path is not within the virtualRoot",{virtualRoot:e,absolutePath:t}),[Ie(n)];if(o===n)return[Fe(n)];var r=o.slice(n.length),i=[];return r.split("/").filter((function(e){return!!e})).reduce((function(e,t){var o={label:a.basename(e),path:Y(n+e),virtualPath:Y(e)};return i.unshift(o),a.dirname(e)}),r),i.unshift(Fe(n)),i},Me=Oe,De=function(){function e(e){this.logger=e,this.clickedCrumb=new t.EventEmitter}return Object.defineProperty(e.prototype,"currentPath",{set:function(e){this._currentPath=e,this.makeCrumbs(e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"config",{set:function(e){this._config=e,this.makeCrumbs(this._currentPath)},enumerable:!1,configurable:!0}),e.prototype.makeCrumbs=function(e){if(this._config){var t=this._config.virtualRoot;this.crumbs=Me(t,e||t),this.logger.info("makeCrumbs",{crumbs:this.crumbs,virtualRoot:t,newPath:e})}},e.prototype.onClickCrumb=function(e){this.logger.info("onClickCrumb",{crumb:e}),this.clickedCrumb.emit(e.path)},e}();De.decorators=[{type:t.Component,args:[{selector:"bread-crumbs",template:'\n    <div class="flex-row align-center">\n      <div\n        class="flex-row align-center"\n        *ngFor="let crumb of crumbs; let first = first; let last = last"\n      >\n        <div class="divider" *ngIf="!first">\n          >\n        </div>\n        <button\n          #myButton\n          class="crumb"\n          mat-raised-button\n          color="secondary"\n          [disabled]="last"\n          (click)="onClickCrumb(crumb); myButton.disabled = true"\n        >\n          <mat-icon *ngIf="crumb.icon">{{ crumb.icon }}</mat-icon>\n          {{ crumb.label }}\n        </button>\n      </div>\n    </div>\n  ',styles:["h1,h2,h3,h4,h5,h6,i,mat-chip,p,small,span{font-family:sans-serif}.is-red{background:red}.flex-col{display:flex;flex-direction:column}.flex-row{display:flex;flex-direction:row}.align-center{align-items:center}.align-top{align-items:start}.align-bottom{align-items:end}.fit-content{width:-moz-fit-content;width:fit-content}.sans-serif{font-family:sans-serif}.has-pointer{cursor:pointer}.has-ellipsis{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.scroll-x{overflow-x:auto}.full-width{width:100%}.text-center{text-align:center}.space-between{justify-content:space-between}.break-word{overflow-wrap:break-word;word-break:break-all}.capitalize{text-transform:capitalize}.p5{padding:5px}.m0{margin:0}.mb-10{margin-bottom:10px}.mr-10{margin-right:10px}.m-10{margin:10px}.color-grey{color:#8c8c8c}.rounded{border-radius:5px}.bg-grey-light{background-color:rgba(95,95,95,.2)}.bg-grey-dark{background-color:rgba(50,50,50,.39)}.bg-grey-hover{transition:background-color .5s}.bg-grey-hover:hover{background-color:rgba(95,95,95,.336)}.color-white{color:#fff}.color-grey-hover{transition:color .5s}.color-grey-hover:hover{color:#444}.color-black{color:#000}.action-toolbar{height:55px}.top-toolbar-label{font-size:.8em;margin:0}.top-toolbar{height:20px;padding-top:3px}"]}]}],De.ctorParameters=function(){return[{type:G}]},De.propDecorators={clickedCrumb:[{type:t.Output}],currentPath:[{type:t.Input}],config:[{type:t.Input}]};var Ee=function(){function e(){this.clearSelected=new t.EventEmitter}return e.prototype.executeAction=function(e,t){return _(this,void 0,void 0,(function(){return N(this,(function(n){switch(n.label){case 0:return[4,e.onClick(t)];case 1:return n.sent(),this.clearSelected.emit(),[2]}}))}))},e}();Ee.decorators=[{type:t.Component,args:[{selector:"bulk-actions",template:'\n    <mat-toolbar color="primary">\n      <mat-toolbar-row class="top-toolbar">\n        <span class="top-toolbar-label">\n          Bulk Actions\n        </span>\n      </mat-toolbar-row>\n      <mat-toolbar-row class="action-toolbar scroll-x">\n        <div class="flex-row" *ngIf="bulkSelected$ | async as selected">\n          <div *ngFor="let action of bulkActions">\n            <button\n              class="mr-10 flex-row align-center"\n              mat-raised-button\n              [disabled]="action.$disabled | async"\n              [color]="action.color"\n              (click)="executeAction(action, selected)"\n            >\n              <mat-icon>{{ action.icon }}</mat-icon>\n              {{ action.label }}\n            </button>\n          </div>\n        </div>\n      </mat-toolbar-row>\n    </mat-toolbar>\n  ',styles:["h1,h2,h3,h4,h5,h6,i,mat-chip,p,small,span{font-family:sans-serif}.is-red{background:red}.flex-col{display:flex;flex-direction:column}.flex-row{display:flex;flex-direction:row}.align-center{align-items:center}.align-top{align-items:start}.align-bottom{align-items:end}.fit-content{width:-moz-fit-content;width:fit-content}.sans-serif{font-family:sans-serif}.has-pointer{cursor:pointer}.has-ellipsis{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.scroll-x{overflow-x:auto}.full-width{width:100%}.text-center{text-align:center}.space-between{justify-content:space-between}.break-word{overflow-wrap:break-word;word-break:break-all}.capitalize{text-transform:capitalize}.p5{padding:5px}.m0{margin:0}.mb-10{margin-bottom:10px}.mr-10{margin-right:10px}.m-10{margin:10px}.color-grey{color:#8c8c8c}.rounded{border-radius:5px}.bg-grey-light{background-color:rgba(95,95,95,.2)}.bg-grey-dark{background-color:rgba(50,50,50,.39)}.bg-grey-hover{transition:background-color .5s}.bg-grey-hover:hover{background-color:rgba(95,95,95,.336)}.color-white{color:#fff}.color-grey-hover{transition:color .5s}.color-grey-hover:hover{color:#444}.color-black{color:#000}.action-toolbar{height:55px}.top-toolbar-label{font-size:.8em;margin:0}.top-toolbar{height:20px;padding-top:3px}"]}]}],Ee.propDecorators={bulkActions:[{type:t.Input}],bulkSelected$:[{type:t.Input}],clearSelected:[{type:t.Output}]};var Re=function(){};function Te(e){return _(this,void 0,void 0,(function(){return N(this,(function(t){return[2,new Promise((function(t){return setTimeout(t,e)}))]}))}))}Re.decorators=[{type:t.Component,args:[{selector:"main-actions",template:'\n    <mat-toolbar>\n      <mat-toolbar-row class="top-toolbar">\n        <span class="top-toolbar-label">\n          Folder Actions\n        </span>\n      </mat-toolbar-row>\n      <mat-toolbar-row class="action-toolbar scroll-x">\n        <div *ngFor="let action of mainActions">\n          <button\n            class="mr-10 has-pointer"\n            mat-raised-button\n            [color]="action.color"\n            (click)="action.onClick(action)"\n            [disabled]="action.$disabled | async"\n          >\n            <mat-icon inline="true">{{ action.icon }}</mat-icon>\n            {{ action.label }}\n          </button>\n        </div>\n      </mat-toolbar-row>\n    </mat-toolbar>\n  ',styles:["h1,h2,h3,h4,h5,h6,i,mat-chip,p,small,span{font-family:sans-serif}.is-red{background:red}.flex-col{display:flex;flex-direction:column}.flex-row{display:flex;flex-direction:row}.align-center{align-items:center}.align-top{align-items:start}.align-bottom{align-items:end}.fit-content{width:-moz-fit-content;width:fit-content}.sans-serif{font-family:sans-serif}.has-pointer{cursor:pointer}.has-ellipsis{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.scroll-x{overflow-x:auto}.full-width{width:100%}.text-center{text-align:center}.space-between{justify-content:space-between}.break-word{overflow-wrap:break-word;word-break:break-all}.capitalize{text-transform:capitalize}.p5{padding:5px}.m0{margin:0}.mb-10{margin-bottom:10px}.mr-10{margin-right:10px}.m-10{margin:10px}.color-grey{color:#8c8c8c}.rounded{border-radius:5px}.bg-grey-light{background-color:rgba(95,95,95,.2)}.bg-grey-dark{background-color:rgba(50,50,50,.39)}.bg-grey-hover{transition:background-color .5s}.bg-grey-hover:hover{background-color:rgba(95,95,95,.336)}.color-white{color:#fff}.color-grey-hover{transition:color .5s}.color-grey-hover:hover{color:#444}.color-black{color:#000}.action-toolbar{height:55px}.top-toolbar-label{font-size:.8em;margin:0}.top-toolbar{height:20px;padding-top:3px}","\n      .top-toolbar-label {\n        color: #8a8a8a;\n      }\n    "]}]}],Re.propDecorators={mainActions:[{type:t.Input}]};var Ae={defaultIcon:{name:"file"},icons:[{name:"word",fileExtensions:["doc","docx","rtf"]},{name:"pdf",fileExtensions:["pdf"]},{name:"table",fileExtensions:["xlsx","xls","csv","tsv"]},{name:"html",fileExtensions:["html","htm","xhtml","html_vm","asp"]},{name:"markdown",fileExtensions:["md","markdown","rst"]},{name:"yaml",fileExtensions:["yaml","YAML-tmLanguage","yml"]},{name:"xml",fileExtensions:["xml","plist","xsd","dtd","xsl","xslt","resx","iml","xquery","tmLanguage","manifest","project"],fileNames:[".htaccess"]},{name:"image",fileExtensions:["png","jpeg","jpg","gif","svg","ico","tif","tiff","psd","psb","ami","apx","bmp","bpg","brk","cur","dds","dng","exr","fpx","gbr","img","jbig2","jb2","jng","jxr","pbm","pgf","pic","raw","webp","eps"]},{name:"tex",fileExtensions:["tex","cls","sty"]},{name:"powerpoint",fileExtensions:["pptx","ppt","pptm","potx","potm","ppsx","ppsm","pps","ppam","ppa"]},{name:"video",fileExtensions:["webm","mkv","flv","vob","ogv","ogg","gifv","avi","mov","qt","wmv","yuv","rm","rmvb","mp4","m4v","mpg","mp2","mpeg","mpe","mpv","m2v"]},{name:"audio",fileExtensions:["mp3","flac","m4a","wma","aiff"]},{name:"document",fileExtensions:["txt"]}]},je=function(e){if(!(e=e.toLowerCase())||!e.includes("."))return Ae.defaultIcon.name;var t=He(e),n=Ae.icons.filter((function(e){return!!e.fileExtensions&&!!e.fileExtensions.filter((function(e){return e===t})).length})),o=Ae.icons.filter((function(t){return!!t.fileNames&&!!t.fileNames.filter((function(t){return t===e})).length}));return o.length?o[0].name:n.length?n[0].name:Ae.defaultIcon.name},He=function(e){return e.split(".").pop()},Ue=function(){function e(e){this.logger=e,this.clickedDownload=new t.EventEmitter}return Object.defineProperty(e.prototype,"file",{get:function(){return this._file},set:function(e){this._file=e,e&&(this.logger.info("file-details: set file",{newFile:e}),this.isFile="file"===this.file.type,this.isImage="image"===je(this.file.name),this.setImageUrl().catch((function(e){return console.error(e)})),this.setPermissions())},enumerable:!1,configurable:!0}),e.prototype.getFileType=function(e){return je(e)},Object.defineProperty(e.prototype,"hasInput",{get:function(){return!!this.file},enumerable:!1,configurable:!0}),e.prototype.setImageUrl=function(){return _(this,void 0,void 0,(function(){var e,t;return N(this,(function(n){switch(n.label){case 0:this.imageUrl=null,n.label=1;case 1:return n.trys.push([1,4,,5]),[4,Te(300)];case 2:return n.sent(),this.hasInput&&this.isFile?(e=this,[4,this.fileSystem.CreateDownloadLink(this.file)]):[2];case 3:return e.imageUrl=n.sent(),[3,5];case 4:return t=n.sent(),this.logger.error("Error setting ImageUrl",{error:t},t),[3,5];case 5:return[2]}}))}))},e.prototype.setPermissions=function(){if(this._file&&this._file.permissions)try{var e=this._file.permissions;this.readers=e.readers,this.writers=e.writers,this.others=e.others}catch(e){this.logger.error("file-details: setPermissions",{error:e,file:this._file})}},e.prototype.getFolderSize=function(e){return e.metaData?this.config.folderSizePath.split(".").reduce((function(e,t){return e[t]}),e):e.size},e}();Ue.decorators=[{type:t.Component,args:[{selector:"ngx-filemanager-file-details",template:'\n    <div class="details-container ml-5">\n      <div *ngIf="!hasInput" class="none-selected">\n        <h2>No item selected ...</h2>\n      </div>\n      <div *ngIf="hasInput">\n        <mat-toolbar color="primary">\n          <mat-toolbar-row class="title-row">\n            <h2 *ngIf="isFile">File Details</h2>\n            <h2 *ngIf="!isFile">Directory Details</h2>\n          </mat-toolbar-row>\n          <mat-toolbar-row class="action-row" *ngFor="let action of actions">\n            <button\n              mat-raised-button\n              [matTooltip]="action.toolTip"\n              [color]="action.color"\n              (click)="action.onClick(file)"\n              [disabled]="action.$disabled | async"\n            >\n              <mat-icon>{{ action.icon }}</mat-icon>\n              <span>{{ action.label }}</span>\n            </button>\n          </mat-toolbar-row>\n        </mat-toolbar>\n        <span class="flex-row space-between align-top mt-5">\n          <div>\n            <h5>Name</h5>\n            <h6 class="filename">{{ file.name }}</h6>\n          </div>\n        </span>\n        <h5 class="mt-5">Size</h5>\n        <h6 *ngIf="isFile">{{ file.size | fileSize }}</h6>\n        <h6 *ngIf="!isFile&&config.folderSizePath">{{ getFolderSize(file) | fileSize }}</h6>\n        <h5 class="mt-5">Date</h5>\n        <h6>{{ file.date | date: \'short\' }}</h6>\n        <span class="flex-row space-between align-top mt-5">\n          <div>\n            <h5>Permissions</h5>\n            <div class="mb-10">\n              <div *ngIf="readers?.length">\n                <h6>Who can see this</h6>\n                <mat-chip-list>\n                  <mat-chip *ngFor="let entity of readers">\n                    <mat-icon>people</mat-icon>\n                    <span>{{ entity }}</span>\n                  </mat-chip>\n                </mat-chip-list>\n              </div>\n              <div *ngIf="config?.showWriters && writers?.length">\n                <h6>Who can edit this</h6>\n                <mat-chip-list>\n                  <mat-chip *ngFor="let entity of writers">\n                    <mat-icon>people</mat-icon>\n                    <span>{{ entity }}</span>\n                  </mat-chip>\n                </mat-chip-list>\n              </div>\n              <div *ngIf="config?.showOthers && others">\n                <h6>Everyone else can</h6>\n                <mat-chip-list>\n                  <mat-chip>\n                    {{ others }}\n                  </mat-chip>\n                </mat-chip-list>\n              </div>\n            </div>\n          </div>\n        </span>\n        <h5 class="mt-5">Full Path</h5>\n        <h6>{{ file.fullPath }}</h6>\n        <h5 class="mt-5">Type</h5>\n        <h6 *ngIf="!isFile">Directory</h6>\n        <h6 *ngIf="isFile" class="capitalize ">\n          {{ getFileType(file.name) }}\n        </h6>\n        <div *ngIf="isFile" class="flex-row space-between align-top mt-5">\n          <div>\n            <h5>Download</h5>\n            <div *ngIf="isImage" class="preview">\n              <i>Image Preview</i>\n              <div\n                class="has-pointer"\n                (click)="this.clickedDownload.emit(file)"\n              >\n                <img *ngIf="imageUrl" [src]="imageUrl" />\n              </div>\n            </div>\n            <div *ngIf="!isImage">\n              <h6 class="no-preview-text">\n                No preview available\n              </h6>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  ',styles:["\n      .filename {\n        padding-right: 10px;\n      }\n      .none-selected {\n        color: grey;\n        text-align: center;\n        width: 100%;\n        margin-top: 100px;\n      }\n      .mb-10 {\n        margin-bottom: 10px;\n      }\n      .mt-5 {\n        margin-top: 10px;\n      }\n      .ml-5 {\n        margin-left: 5px;\n      }\n      .no-preview-text {\n        color: grey;\n        font-decoration: italic;\n      }\n      h5 {\n        margin: 0px;\n        color: #616161;\n        font-weight: normal;\n      }\n      h6 {\n        margin: 0px;\n        font-size: 1em;\n        overflow-wrap: break-word;\n        font-weight: bold;\n        margin-bottom: 5px;\n        margin-top: 2px;\n      }\n      img {\n        max-width: 100%;\n        max-height: 400px;\n      }\n      .preview {\n        opacity: 1;\n        transition: opacity 1s;\n      }\n      .title-row {\n        height: 45px;\n        padding-left: 8px;\n      }\n      .action-row {\n        height: 45px;\n        padding-left: 8px;\n      }\n      .action-row:last-child {\n        height: 48px;\n        padding-bottom: 4px;\n      }\n    ","h1,h2,h3,h4,h5,h6,i,mat-chip,p,small,span{font-family:sans-serif}.is-red{background:red}.flex-col{display:flex;flex-direction:column}.flex-row{display:flex;flex-direction:row}.align-center{align-items:center}.align-top{align-items:start}.align-bottom{align-items:end}.fit-content{width:-moz-fit-content;width:fit-content}.sans-serif{font-family:sans-serif}.has-pointer{cursor:pointer}.has-ellipsis{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.scroll-x{overflow-x:auto}.full-width{width:100%}.text-center{text-align:center}.space-between{justify-content:space-between}.break-word{overflow-wrap:break-word;word-break:break-all}.capitalize{text-transform:capitalize}.p5{padding:5px}.m0{margin:0}.mb-10{margin-bottom:10px}.mr-10{margin-right:10px}.m-10{margin:10px}.color-grey{color:#8c8c8c}.rounded{border-radius:5px}.bg-grey-light{background-color:rgba(95,95,95,.2)}.bg-grey-dark{background-color:rgba(50,50,50,.39)}.bg-grey-hover{transition:background-color .5s}.bg-grey-hover:hover{background-color:rgba(95,95,95,.336)}.color-white{color:#fff}.color-grey-hover{transition:color .5s}.color-grey-hover:hover{color:#444}.color-black{color:#000}.action-toolbar{height:55px}.top-toolbar-label{font-size:.8em;margin:0}.top-toolbar{height:20px;padding-top:3px}"]}]}],Ue.ctorParameters=function(){return[{type:G}]},Ue.propDecorators={file:[{type:t.Input}],fileSystem:[{type:t.Input}],config:[{type:t.Input}],actions:[{type:t.Input}],clickedDownload:[{type:t.Output}]};var ze=function(){function e(){var e=this;this.internalControl=new o.FormControl,this._destroyed=new s.Subject,this.disabled=!1,this.propagateOnChange=function(){},this.onTouched=function(){};var t=this.ngOnDestroy;this.ngOnDestroy=function(){e.destroy(),t.apply(e)};var n=this.ngOnInit;this.ngOnInit=function(){e.init(),n.apply(e)}}return e.prototype.ngOnInit=function(){},e.prototype.ngOnDestroy=function(){},e.prototype.init=function(){var e=this;if(this._destroyed.next(),this.autoCompleteObscureName=c.v4(),this.internalControl.valueChanges.pipe(i.takeUntil(this._destroyed)).pipe(i.auditTime(100)).subscribe((function(){e._value=e.internalControl.value,e.onChange(e._value),e.onTouched()})),!this.placeholder){var t=function(e){return e.replace(/([A-Z])/g," $1").trim().replace(/_/g," ").split(" ").map((function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()})).join(" ")}(this.formControlName+"");this.placeholder=t}},e.prototype.destroy=function(){this._destroyed.next()},Object.defineProperty(e.prototype,"value",{get:function(){return this._value},set:function(e){this._value=e,this.internalControl.setValue(e)},enumerable:!1,configurable:!0}),e.prototype.writeValue=function(e){this.value=e},e.prototype.registerOnChange=function(e){this.propagateOnChange=e},e.prototype.registerOnTouched=function(e){this.onTouched=e},e.prototype.setDisabledState=function(e){var t=this;this.disabled=e,setTimeout((function(){e?t.internalControl.disable():t.internalControl.enable()}))},e.prototype.validate=function(e){e.errors,e.value;return this.internalControl.setValidators(e.validator),this.validationError?{validationError:{valid:!1}}:null},e.prototype.onChange=function(e){this.validationError=this.CheckValueIsValid(),this.validationError?this.propagateOnChange(this.value):this.propagateOnChange(e)},e.prototype.CheckValueIsValid=function(){return null},e}();ze.decorators=[{type:t.Directive}],ze.ctorParameters=function(){return[]},ze.propDecorators={formControlName:[{type:t.Input}],placeholder:[{type:t.Input}]};var $e=function(e){function n(n){var o=e.call(this)||this;return o.ns=n,o.placeholder="upload here",o.config={},o.uploadStatusChanged=new t.EventEmitter,o.destroyed=new s.Subject,o}return function(e,t){function n(){this.constructor=e}$(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}(n,e),n.prototype.ngOnInit=function(){var e,t=this;e=U.apps.length?U.apps[0]:U.initializeApp(this.config.firebaseConfig),this.storage=e.storage(this.currentBucketName()),s.timer(0,1e3).pipe(i.takeUntil(this.destroyed)).subscribe((function(){t.checkAllUploadsAreDone()}))},n.prototype.ngOnDestroy=function(){this.destroyed.next()},n.prototype.checkAllUploadsAreDone=function(){var e=!this.value.filter((function(e){return!!e})).filter((function(e){return!!e.value})).filter((function(e){return!!e.value.props})).map((function(e){return e.value.props.completed})).reduce((function(e,t){return e&&t}),!0);this.uploadStatusChanged.emit(e)},Object.defineProperty(n.prototype,"isMultiple",{get:function(){return this.config&&1!==this.config.maxFiles},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"maxReached",{get:function(){return this.config&&this.config.maxFiles&&this.value&&this.config.maxFiles===this.value.length},enumerable:!1,configurable:!0}),n.prototype.currentBucketName=function(){return this.config.bucketname||this.config.firebaseConfig.storageBucket},n.prototype.clickRemoveTag=function(e){return _(this,void 0,void 0,(function(){var t;return N(this,(function(n){switch(n.label){case 0:if(this.ensureValueIsArray(),this.value=this.value.filter((function(t){return t.id!==e.id})),!e.bucket_path)return[3,4];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.storage.refFromURL(e.bucket_path).delete()];case 2:return n.sent(),console.log("form-files: clickRemoveTag() file deleted from storage",{fileObject:e}),[3,4];case 3:return t=n.sent(),console.log("form-files: clickRemoveTag() problem deleting file",t),[3,4];case 4:return[2]}}))}))},n.prototype.onFileChange=function(e){var t=this;if(e.target.files&&e.target.files.length){var n=e.target.files;Array.from(n).map((function(e){return t.beginUploadTask(e)}))}},n.prototype.beginUploadTask=function(e){return _(this,void 0,void 0,(function(){var t,n,o,r,s,a,l,c,u=this;return N(this,(function(p){switch(p.label){case 0:return t="gs://"+this.currentBucketName(),n=e.name,o=e.name,r=this.config.directory,s=V(t)+"/"+V(r),a=V(s)+"/"+n,console.log("beginUploadTask()",{fileData:e,bucketPath:t,fullPath:a}),"image/*"!==e.type?[3,2]:[4,this.parseAndCompress(e)];case 1:return l=p.sent(),[3,3];case 2:l=e,p.label=3;case 3:return[4,this.addFile(n,o,a)];case 4:return p.sent(),(c=this.storage.refFromURL(a).put(l)).on(U.storage.TaskEvent.STATE_CHANGED,{next:function(e){return u.onNext(e,a)},error:function(e){return u.onError(e)},complete:function(){return u.onComplete(a,n,o)}}),this.destroyed.pipe(i.take(1)).subscribe((function(){c.cancel()})),[2]}}))}))},n.prototype.parseAndCompress=function(e){return _(this,void 0,void 0,(function(){var t,n,o,r,i,s,a;return N(this,(function(l){switch(l.label){case 0:return this.config.imageCompressionMaxSize||this.config.imageCompressionQuality?(t=this.config.imageCompressionMaxSize||1800,n=this.config.imageCompressionQuality||.6,[4,_e(e)]):[2,e];case 1:return[4,Ne(o=l.sent(),t,n,"image/jpeg")];case 2:return r=l.sent(),i=this.getFileSizeKiloBytes(o),s=this.getFileSizeKiloBytes(r),a=function(e){for(var t=atob(e.split(",")[1]),n=e.split(",")[0].split(":")[1].split(";")[0],o=new ArrayBuffer(t.length),r=new Uint8Array(o),i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return new Blob([o],{type:n})}(r),console.log("app-tags-files.component: optimized image...\n  --\x3e old="+i+" kb\n  --\x3e new="+s+" kb"),[2,a]}}))}))},n.prototype.getFileSizeKiloBytes=function(e){return(Math.round(3*(e.length-20)/4)/1024).toFixed(0)},n.prototype.onNext=function(e,t){return _(this,void 0,void 0,(function(){var n,o;return N(this,(function(r){if(this.ensureValueIsArray(),e.state===U.storage.TaskState.RUNNING)n=this.value.find((function(e){return e.bucket_path===t})),o=e.bytesTransferred/e.totalBytes*100,console.log("Upload is running",{file:n,fullPath:t,progress:o,snapshot:e}),n.value.props.progress=o;return[2]}))}))},n.prototype.onError=function(e){this.ns.notify("storage/unauthorized","Error Uploading"),console.error("onError(error)",{error:e},e)},n.prototype.onComplete=function(e,t,n){return _(this,void 0,void 0,(function(){var o,r,i;return N(this,(function(s){switch(s.label){case 0:return console.log("onComplete()",{}),[4,this.storage.refFromURL(e).getDownloadURL()];case 1:return o=s.sent(),r="image"===je(n),this.ensureValueIsArray(),(i=this.value.find((function(e){return e.id===t}))).id=o,r&&(i.imageurl=o),i.value.props.completed=!0,this.writeValue(this.value),[2]}}))}))},n.prototype.addFile=function(e,t,n){var o="/assets/fileicons/"+je(t)+".svg",r={id:e,fileicon:o,imageurl:null,bucket_path:n,value:{name:t,props:{thumb:null,fileicon:o,progress:0,completed:!1}}};this.ensureValueIsArray(),this.value.push(r)},n.prototype.ensureValueIsArray=function(){Array.isArray(this.value)||this.writeValue([])},n}(ze);function _e(e){return _(this,void 0,void 0,(function(){var t;return N(this,(function(n){return t=new FileReader,[2,new Promise((function(n,o){t.onload=function(e){n(e.target.result)},t.onerror=function(e){o(e)},t.readAsDataURL(e)}))]}))}))}function Ne(e,t,n,o,r){return _(this,void 0,void 0,(function(){var i,s,a,l,c,u,p;return N(this,(function(h){switch(h.label){case 0:return o=o||"image/jpeg",n=n||.7,(i=new Image).src=e,[4,new Promise((function(e){i.onload=function(){e("")}}))];case 1:return h.sent(),s=i.width,a=i.height,l=Math.floor(a/s*t),(c=document.createElement("canvas")).width=t,c.height=l,(u=c.getContext("2d")).drawImage(i,0,0,t,l),p=c.toDataURL(o,n),r&&console.log("quill.imageCompressor: downscaling image...",{args:{dataUrl:e,newWidth:t,imageType:o,imageQuality:n},image:i,oldWidth:s,oldHeight:a,newHeight:l,canvas:c,ctx:u,newDataUrl:p}),[2,p]}}))}))}$e.decorators=[{type:t.Component,args:[{selector:"form-file-firebase",template:'\n    <div>\n      <label class="custom-file-upload">\n        <input\n          *ngIf="isMultiple"\n          class="hidden"\n          type="file"\n          multiple\n          [disabled]="disabled || maxReached"\n          (change)="onFileChange($event)"\n        />\n        <input\n          *ngIf="!isMultiple"\n          class="hidden"\n          type="file"\n          [disabled]="disabled || maxReached"\n          (change)="onFileChange($event)"\n        />\n        {{ placeholder }}\n        <div class="max-files" *ngIf="maxReached && !disabled">\n          Max Uploaded - Limit of {{ config.maxFiles }} file(s) reached. Remove\n          files to change uploads\n        </div>\n      </label>\n      <app-uploaded-files-list\n        [disabled]="disabled"\n        [uploadedFiles]="this.value"\n        (clickRemoveTag)="this.clickRemoveTag($event)"\n      >\n      </app-uploaded-files-list>\n    </div>\n  ',providers:[{provide:o.NG_VALUE_ACCESSOR,useExisting:t.forwardRef((function(){return $e})),multi:!0},{provide:o.NG_VALIDATORS,useExisting:t.forwardRef((function(){return $e})),multi:!0}],styles:["\n      .custom-file-upload {\n        border: 4px dashed #ccc;\n        display: inline-block;\n        padding: 35px 0px;\n        cursor: pointer;\n        width: calc(100% - 8px);\n        text-align: center;\n        font-size: 1.5em;\n        color: #777;\n      }\n      .hidden {\n        display: none;\n      }\n      .max-files {\n        font-size: 0.9em;\n        color: orange;\n        font-style: italic;\n      }\n    "]}]}],$e.ctorParameters=function(){return[{type:ne}]},$e.propDecorators={placeholder:[{type:t.Input}],config:[{type:t.Input}],uploadStatusChanged:[{type:t.Output}]};var Le=function(){function e(){this.uploadedFiles=[],this.clickRemoveTag=new t.EventEmitter}return e.prototype.getProgress=function(e){return this.isDone(e)?100:e&&e.value&&e.value.props?.95*e.value.props.progress:100},e.prototype.isDone=function(e){return!!(e&&e.value&&e.value.props)&&e.value.props.completed},e}();Le.decorators=[{type:t.Component,args:[{selector:"app-uploaded-files-list",template:'\n    <p *ngIf="uploadedFiles?.length">Uploaded files:</p>\n    <div>\n      <div *ngFor="let file of uploadedFiles">\n        <div class="full-width flex-h">\n          <mat-icon id="i-done" *ngIf="!disabled && isDone(file)"\n            >done</mat-icon\n          >\n          <img class="file-icon" image [src]="file[\'fileicon\']" />\n          <a class="full-width flex-h has-ellipsis" [href]="file.id" target="_blank">\n            <span class="has-ellipsis">{{ file.value.name }}</span>\n            <mat-icon class="i-open">open_in_new</mat-icon>\n            <img\n              *ngIf="file[\'imageurl\']"\n              class="file-thumb"\n              image\n              [src]="file[\'imageurl\']"\n            />\n          </a>\n          <mat-icon\n            *ngIf="!disabled"\n            class="has-pointer"\n            (click)="this.clickRemoveTag.emit(file)"\n            >cancel</mat-icon\n          >\n        </div>\n        <div class="full-width">\n          <mat-progress-bar\n            class="progress"\n            mode="determinate"\n            [value]="getProgress(file)"\n          ></mat-progress-bar>\n        </div>\n      </div>\n    </div>\n  ',styles:["\n      .full-width {\n        width: 100%;\n      }\n      .flex-h {\n        display: flex;\n        flex-direction: row;\n        align-items: center;\n      }\n      .has-pointer {\n        cursor: pointer;\n      }\n      .file-link {\n        display: flex;\n        align-items: center;\n      }\n      .file-thumb,\n      .file-icon {\n        margin: 0px 10px;\n        height: 30px;\n      }\n      .file-thumb {\n        background-color: #ddd;\n      }\n      .i-open {\n        font-size: 1em;\n      }\n      .has-ellipsis {\n        text-overflow: ellipsis;\n        overflow: hidden;\n        white-space: nowrap;\n      }\n    "]}]}],Le.propDecorators={disabled:[{type:t.Input}],uploadedFiles:[{type:t.Input}],clickRemoveTag:[{type:t.Output}]};var Be=function(){};Be.decorators=[{type:t.NgModule,args:[{imports:[n.CommonModule,o.FormsModule,o.ReactiveFormsModule,d.MatProgressBarModule,f.MatInputModule,m.MatIconModule],exports:[$e],declarations:[$e,Le],providers:[]}]}];var Ge=function(){function e(e,t,n,o){this.http=e,this.url=t,this.logger=n,this.LOG_ID=o,this.options={headers:{}}}return e.prototype.AddBody=function(e){return this.body=Object.assign(Object.assign({},this.body),e),this},e.prototype.PatchBody=function(e){var t=e;return this.body=Object.assign(Object.assign({},this.body),t),this},e.prototype.PatchHeaders=function(e){return this.options.headers=Object.assign(Object.assign({},this.options.headers),e),this},e.prototype.MakeJson=function(){this.options.responseType="json",this.options.headers["Content-Type"]="application/json"},e.prototype.makeRequestKey=function(){return this.url+JSON.stringify(this.body||{})},e.prototype.POST=function(){return _(this,void 0,void 0,(function(){var e,t;return N(this,(function(n){switch(n.label){case 0:this.makeRequestKey(),n.label=1;case 1:return n.trys.push([1,3,,4]),this.logger.info(this.LOG_ID+" FileSystemRequestBuilder",{url:this.url,body:this.body,options:this.options}),[4,this.http.post(this.url,this.body,this.options).pipe(i.take(1)).toPromise()];case 2:return[2,n.sent()];case 3:if(e=n.sent(),console.error("API Post Error",{apiErrorResponse:e}),e.error&&e.error.errorDetail)throw t=e.error.errorDetail,new Error("API Response: "+t);throw new Error("API request failed, status:"+e.statusText);case 4:return[2]}}))}))},e}();var qe=function(){function e(e,t){this.http=e,this.logger=t,this.LOG_ID=Math.random().toString(32).slice(2,10)}return e.prototype.makeAPIRequest=function(e){return this.logger.info("makeAPIRequest",{action:e,context:this}),new Ge(this.http,this.apiEndpoint,this.logger,this.LOG_ID).AddBody({action:e,bucketname:this.bucketname,isAdmin:this.isAdmin})},e.prototype.Initialize=function(e){this.bucketname=e.bucketname,this.isAdmin=e.isAdmin,this.apiEndpoint=J(e.apiEndpoint)},e.prototype.List=function(e){return this.makeAPIRequest("list").PatchBody({path:e}).POST()},e.prototype.CreateFolder=function(e,t){return this.makeAPIRequest("createFolder").PatchBody({newPath:e}).POST()},e.prototype.Copy=function(e,t){return this.makeAPIRequest("copy").PatchBody({singleFileName:e,newPath:t}).POST()},e.prototype.Move=function(e,t){return this.makeAPIRequest("move").PatchBody({items:[e],newPath:t}).POST()},e.prototype.Rename=function(e,t){return this.makeAPIRequest("rename").PatchBody({item:e,newItemPath:t}).POST()},e.prototype.Edit=function(e,t){return this.makeAPIRequest("edit").PatchBody({item:e,content:t}).POST()},e.prototype.Getcontent=function(e){return this.makeAPIRequest("getContent").PatchBody({item:e}).POST()},e.prototype.SetPermissions=function(e,t,n,o){return this.makeAPIRequest("changePermissions").PatchBody({items:[e],role:t,entity:n,recursive:o}).POST()},e.prototype.MoveMultiple=function(e,t){return this.makeAPIRequest("move").PatchBody({items:e,newPath:t}).POST()},e.prototype.CopyMultiple=function(e,t){return this.makeAPIRequest("copy").PatchBody({items:e,newPath:t}).POST()},e.prototype.SetPermissionsMultiple=function(e,t,n,o){return this.makeAPIRequest("changePermissions").PatchBody({items:e,role:t,entity:n,recursive:o}).POST()},e.prototype.SetPermissionsObjectMultiple=function(e,t,n){return this.makeAPIRequest("changePermissionsObject").PatchBody({items:e,permissionsObj:t,recursive:n}).POST()},e.prototype.Remove=function(e){return this.makeAPIRequest("remove").PatchBody({items:e}).POST()},e.prototype.GetSingle=function(e){return this.makeAPIRequest("getSingle").PatchBody({item:e}).POST()},e.prototype.GetUploadApiUrl=function(e){return this.apiEndpoint+"/upload?bucketname="+this.bucketname+"&directoryPath="+e},e.prototype.CloneProvider=function(){return new e(this.http,this.logger)},e.prototype.CreateDownloadLink=function(e){return _(this,void 0,void 0,(function(){var t,n;return N(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,this.makeAPIRequest("getSingle").PatchBody({item:e.fullPath}).POST()];case 1:return t=o.sent(),[2,t.result.url];case 2:throw n=o.sent(),new Error(n.message);case 3:return[2]}}))}))},e.prototype.Upload=function(e){return _(this,void 0,void 0,(function(){return N(this,(function(e){return[2,null]}))}))},e}();qe.decorators=[{type:t.Injectable}],qe.ctorParameters=function(){return[{type:r.HttpClient},{type:G}]};var Ve=function(){};Ve.decorators=[{type:t.Component,args:[{selector:"base-dialog",template:'\n    <div class="dialog-wrapper">\n      <div class="header sans-serif flex-col align-center">\n        <ng-container *ngTemplateOutlet="header"> </ng-container>\n      </div>\n      <div class="body sans-serif flex-col align-center">\n        <ng-container *ngTemplateOutlet="body"> </ng-container>\n      </div>\n      <div class="actions sans-serif flex-col align-center">\n        <ng-container *ngTemplateOutlet="actions"> </ng-container>\n      </div>\n    </div>\n  ',styles:["\n      .dialog-wrapper {\n        max-height: 80vh;\n        min-width: 400px;\n      }\n      .header {\n      }\n      .body {\n        overflow-y: auto;\n        max-height: 60vh;\n      }\n      .actions {\n        max-height: 200px;\n      }\n    ","h1,h2,h3,h4,h5,h6,i,mat-chip,p,small,span{font-family:sans-serif}.is-red{background:red}.flex-col{display:flex;flex-direction:column}.flex-row{display:flex;flex-direction:row}.align-center{align-items:center}.align-top{align-items:start}.align-bottom{align-items:end}.fit-content{width:-moz-fit-content;width:fit-content}.sans-serif{font-family:sans-serif}.has-pointer{cursor:pointer}.has-ellipsis{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.scroll-x{overflow-x:auto}.full-width{width:100%}.text-center{text-align:center}.space-between{justify-content:space-between}.break-word{overflow-wrap:break-word;word-break:break-all}.capitalize{text-transform:capitalize}.p5{padding:5px}.m0{margin:0}.mb-10{margin-bottom:10px}.mr-10{margin-right:10px}.m-10{margin:10px}.color-grey{color:#8c8c8c}.rounded{border-radius:5px}.bg-grey-light{background-color:rgba(95,95,95,.2)}.bg-grey-dark{background-color:rgba(50,50,50,.39)}.bg-grey-hover{transition:background-color .5s}.bg-grey-hover:hover{background-color:rgba(95,95,95,.336)}.color-white{color:#fff}.color-grey-hover{transition:color .5s}.color-grey-hover:hover{color:#444}.color-black{color:#000}.action-toolbar{height:55px}.top-toolbar-label{font-size:.8em;margin:0}.top-toolbar{height:20px;padding-top:3px}"]}]}],Ve.propDecorators={header:[{type:t.Input}],body:[{type:t.Input}],actions:[{type:t.Input}]};var We=function(){function e(e,t,n){this.logger=e,this.dialogRef=t,this.data=n,this.roleControl=new o.FormControl("READER"),this.roleOptions=["OWNER","WRITER","READER"],this.entityTypeControl=new o.FormControl("group"),this.entityTypeOptions=["user","group"],this.entityControl=new o.FormControl,this.destroyed=new s.Subject,this.items=n.files;var r=n.config;this.$users=r.users,this.$groups=r.groups}return e.prototype.ngOnDestroy=function(){this.destroyed.next()},Object.defineProperty(e.prototype,"EntityControlLabel",{get:function(){return"user"===this.entityTypeControl.value?"User":"Group"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"HasSelectedUser",{get:function(){return"user"===this.entityTypeControl.value},enumerable:!1,configurable:!0}),e.prototype.onSubmit=function(){var e=this.entityControl.value,t=e.uid,n={role:this.roleControl.value,entity:t,files:this.data.files};this.logger.info("onSubmit",{entity:t,choosenValue:e,response:n}),this.dialogRef.close(n)},e.prototype.onCancel=function(){this.dialogRef.close()},e}();We.decorators=[{type:t.Component,args:[{template:'\n    <base-dialog\n      [header]="headerTemplate"\n      [body]="bodyTemplate"\n      [actions]="actionsTemplate"\n    >\n      <ng-template #headerTemplate>\n        <h2>Set Permissions</h2>\n      </ng-template>\n      <ng-template #bodyTemplate>\n        <h5>Selected Items</h5>\n        <ol>\n          <li *ngFor="let file of items">\n            {{ file.name }}\n          </li>\n        </ol>\n\n        <mat-form-field class="full-width">\n          <mat-select\n            matInput\n            [formControl]="entityTypeControl"\n            placeholder="Type"\n          >\n            <mat-option\n              *ngFor="let option of entityTypeOptions"\n              [value]="option"\n            >\n              {{ option }}\n            </mat-option>\n          </mat-select>\n        </mat-form-field>\n\n        <mat-form-field class="full-width" *ngIf="HasSelectedUser">\n          <mat-select\n            matInput\n            [formControl]="entityControl"\n            [placeholder]="EntityControlLabel"\n          >\n            <mat-option *ngFor="let entity of $users | async" [value]="entity">\n              {{ entity.name }}\n            </mat-option>\n          </mat-select>\n        </mat-form-field>\n\n        <mat-form-field class="full-width" *ngIf="!HasSelectedUser">\n          <mat-select\n            matInput\n            [formControl]="entityControl"\n            [placeholder]="EntityControlLabel"\n          >\n            <mat-option *ngFor="let entity of $groups | async" [value]="entity">\n              {{ entity.name }}\n            </mat-option>\n          </mat-select>\n        </mat-form-field>\n\n        <mat-form-field class="full-width">\n          <mat-select\n            matInput\n            [formControl]="roleControl"\n            placeholder="Permissions"\n          >\n            <mat-option *ngFor="let option of roleOptions" [value]="option">\n              {{ option }}\n            </mat-option>\n          </mat-select>\n        </mat-form-field>\n      </ng-template>\n      <ng-template #actionsTemplate>\n        <btns-cancel-ok\n          okIcon="done"\n          okLabel="Set Permissions"\n          (clickedCancel)="onCancel()"\n          (clickedOk)="onSubmit()"\n        >\n        </btns-cancel-ok>\n      </ng-template>\n    </base-dialog>\n  ',styles:["h1,h2,h3,h4,h5,h6,i,mat-chip,p,small,span{font-family:sans-serif}.is-red{background:red}.flex-col{display:flex;flex-direction:column}.flex-row{display:flex;flex-direction:row}.align-center{align-items:center}.align-top{align-items:start}.align-bottom{align-items:end}.fit-content{width:-moz-fit-content;width:fit-content}.sans-serif{font-family:sans-serif}.has-pointer{cursor:pointer}.has-ellipsis{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.scroll-x{overflow-x:auto}.full-width{width:100%}.text-center{text-align:center}.space-between{justify-content:space-between}.break-word{overflow-wrap:break-word;word-break:break-all}.capitalize{text-transform:capitalize}.p5{padding:5px}.m0{margin:0}.mb-10{margin-bottom:10px}.mr-10{margin-right:10px}.m-10{margin:10px}.color-grey{color:#8c8c8c}.rounded{border-radius:5px}.bg-grey-light{background-color:rgba(95,95,95,.2)}.bg-grey-dark{background-color:rgba(50,50,50,.39)}.bg-grey-hover{transition:background-color .5s}.bg-grey-hover:hover{background-color:rgba(95,95,95,.336)}.color-white{color:#fff}.color-grey-hover{transition:color .5s}.color-grey-hover:hover{color:#444}.color-black{color:#000}.action-toolbar{height:55px}.top-toolbar-label{font-size:.8em;margin:0}.top-toolbar{height:20px;padding-top:3px}"]}]}],We.ctorParameters=function(){return[{type:G},{type:l.MatDialogRef},{type:void 0,decorators:[{type:t.Inject,args:[l.MAT_DIALOG_DATA]}]}]};var Ke=function(){function e(e){this.dialogRef=e}return e.prototype.onSubmit=function(){this.dialogRef.close()},e.prototype.onCancel=function(){this.dialogRef.close()},e}();Ke.decorators=[{type:t.Component,args:[{template:'\n    <base-dialog\n      [header]="headerTemplate"\n      [body]="bodyTemplate"\n      [actions]="actionsTemplate"\n    >\n      <ng-template #headerTemplate>\n        <h2>My Details</h2>\n      </ng-template>\n      <ng-template #bodyTemplate>\n        <div>\n          The following details were\n        </div>\n      </ng-template>\n      <ng-template #actionsTemplate>\n        <btns-cancel-ok\n          okIcon="done"\n          okLabel="Create Folder"\n          (clickedCancel)="onCancel()"\n          (clickedOk)="onSubmit()"\n        >\n        </btns-cancel-ok>\n      </ng-template>\n    </base-dialog>\n  ',styles:["h1,h2,h3,h4,h5,h6,i,mat-chip,p,small,span{font-family:sans-serif}.is-red{background:red}.flex-col{display:flex;flex-direction:column}.flex-row{display:flex;flex-direction:row}.align-center{align-items:center}.align-top{align-items:start}.align-bottom{align-items:end}.fit-content{width:-moz-fit-content;width:fit-content}.sans-serif{font-family:sans-serif}.has-pointer{cursor:pointer}.has-ellipsis{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.scroll-x{overflow-x:auto}.full-width{width:100%}.text-center{text-align:center}.space-between{justify-content:space-between}.break-word{overflow-wrap:break-word;word-break:break-all}.capitalize{text-transform:capitalize}.p5{padding:5px}.m0{margin:0}.mb-10{margin-bottom:10px}.mr-10{margin-right:10px}.m-10{margin:10px}.color-grey{color:#8c8c8c}.rounded{border-radius:5px}.bg-grey-light{background-color:rgba(95,95,95,.2)}.bg-grey-dark{background-color:rgba(50,50,50,.39)}.bg-grey-hover{transition:background-color .5s}.bg-grey-hover:hover{background-color:rgba(95,95,95,.336)}.color-white{color:#fff}.color-grey-hover{transition:color .5s}.color-grey-hover:hover{color:#444}.color-black{color:#000}.action-toolbar{height:55px}.top-toolbar-label{font-size:.8em;margin:0}.top-toolbar{height:20px;padding-top:3px}"]}]}],Ke.ctorParameters=function(){return[{type:l.MatDialogRef}]};var Qe=function(){this.clickedOk=new t.EventEmitter,this.clickedCancel=new t.EventEmitter};Qe.decorators=[{type:t.Component,args:[{selector:"btns-cancel-ok",template:'\n    <div class="full-width text-center">\n      <button mat-raised-button (click)="clickedCancel.emit()">\n        <mat-icon>clear</mat-icon>\n        Cancel\n      </button>\n      <button\n        mat-raised-button\n        color="primary"\n        (click)="clickedOk.emit()"\n        [disabled]="okDisabled"\n      >\n        <mat-icon>{{ okIcon }}</mat-icon>\n        {{ okLabel }}\n      </button>\n    </div>\n  ',styles:["\n      button {\n        margin: 5px;\n      }\n    "]}]}],Qe.propDecorators={okDisabled:[{type:t.Input}],okIcon:[{type:t.Input}],okLabel:[{type:t.Input}],clickedOk:[{type:t.Output}],clickedCancel:[{type:t.Output}]};var Ye=function(){function e(e){this.logger=e,this.selectedItem=new g.SelectionModel(!1),this.enterDirectory=new t.EventEmitter,this.selectedDirectory=new t.EventEmitter,this.destroyed=new s.Subject}return e.prototype.ngOnInit=function(){return _(this,void 0,void 0,(function(){var e=this;return N(this,(function(t){return this.selectedItem.changed.pipe(i.takeUntil(this.destroyed)).subscribe((function(){var t=e.selectedItem.selected[0];e.selectedDirectory.emit(t)})),[2]}))}))},e.prototype.ngOnDestroy=function(){this.destroyed.next()},e.prototype.onEnterFolder=function(e){return _(this,void 0,void 0,(function(){return N(this,(function(t){return this.logger.info("onEnterFolder",{folderPath:e}),this.enterDirectory.emit(e),this.selectedDirectory.emit(e),[2]}))}))},e}();Ye.decorators=[{type:t.Component,args:[{selector:"app-file-table-mini-folder-browser",template:'\n    <div class="full-width mini-browser-height">\n      <actions-mini-browser [mainActions]="mainActions"> </actions-mini-browser>\n      <h4 class="p5 m0 color-grey">Folders</h4>\n      <div class="flex-col bg-white">\n        <card-folder\n          *ngFor="let folder of folders"\n          [folder]="folder"\n          [selectedItem]="selectedItem"\n          (enterFolder)="onEnterFolder($event)"\n        >\n        </card-folder>\n      </div>\n    </div>\n  ',providers:[Ce,me,be],styles:["\n      .mini-browser-height {\n        min-height: 400px;\n        max-height: 80vh;\n      }\n      .bg-white {\n        background-color: #fff;\n      }\n    ","h1,h2,h3,h4,h5,h6,i,mat-chip,p,small,span{font-family:sans-serif}.is-red{background:red}.flex-col{display:flex;flex-direction:column}.flex-row{display:flex;flex-direction:row}.align-center{align-items:center}.align-top{align-items:start}.align-bottom{align-items:end}.fit-content{width:-moz-fit-content;width:fit-content}.sans-serif{font-family:sans-serif}.has-pointer{cursor:pointer}.has-ellipsis{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.scroll-x{overflow-x:auto}.full-width{width:100%}.text-center{text-align:center}.space-between{justify-content:space-between}.break-word{overflow-wrap:break-word;word-break:break-all}.capitalize{text-transform:capitalize}.p5{padding:5px}.m0{margin:0}.mb-10{margin-bottom:10px}.mr-10{margin-right:10px}.m-10{margin:10px}.color-grey{color:#8c8c8c}.rounded{border-radius:5px}.bg-grey-light{background-color:rgba(95,95,95,.2)}.bg-grey-dark{background-color:rgba(50,50,50,.39)}.bg-grey-hover{transition:background-color .5s}.bg-grey-hover:hover{background-color:rgba(95,95,95,.336)}.color-white{color:#fff}.color-grey-hover{transition:color .5s}.color-grey-hover:hover{color:#444}.color-black{color:#000}.action-toolbar{height:55px}.top-toolbar-label{font-size:.8em;margin:0}.top-toolbar{height:20px;padding-top:3px}"]}]}],Ye.ctorParameters=function(){return[{type:G}]},Ye.propDecorators={folders:[{type:t.Input}],mainActions:[{type:t.Input}],enterDirectory:[{type:t.Output}],selectedDirectory:[{type:t.Output}]};var Je=function(){};Je.decorators=[{type:t.Component,args:[{selector:"actions-mini-browser",template:'\n    <mat-toolbar color="primary" *ngIf="this.mainActions">\n      <mat-toolbar-row class="top-toolbar">\n        <span class="top-toolbar-label">\n          Actions\n        </span>\n      </mat-toolbar-row>\n      <mat-toolbar-row class="action-toolbar scroll-x">\n        <div *ngFor="let action of mainActions">\n          <button\n            class="action has-pointer"\n            mat-raised-button\n            [color]="action.color"\n            (click)="action.onClick(action)"\n            [disabled]="action.$disabled | async"\n          >\n            <mat-icon inline="true">{{ action.icon }}</mat-icon>\n            {{ action.label }}\n          </button>\n        </div>\n      </mat-toolbar-row>\n    </mat-toolbar>\n  ',styles:["\n      button.action {\n        margin-right: 10px;\n      }\n    ","h1,h2,h3,h4,h5,h6,i,mat-chip,p,small,span{font-family:sans-serif}.is-red{background:red}.flex-col{display:flex;flex-direction:column}.flex-row{display:flex;flex-direction:row}.align-center{align-items:center}.align-top{align-items:start}.align-bottom{align-items:end}.fit-content{width:-moz-fit-content;width:fit-content}.sans-serif{font-family:sans-serif}.has-pointer{cursor:pointer}.has-ellipsis{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.scroll-x{overflow-x:auto}.full-width{width:100%}.text-center{text-align:center}.space-between{justify-content:space-between}.break-word{overflow-wrap:break-word;word-break:break-all}.capitalize{text-transform:capitalize}.p5{padding:5px}.m0{margin:0}.mb-10{margin-bottom:10px}.mr-10{margin-right:10px}.m-10{margin:10px}.color-grey{color:#8c8c8c}.rounded{border-radius:5px}.bg-grey-light{background-color:rgba(95,95,95,.2)}.bg-grey-dark{background-color:rgba(50,50,50,.39)}.bg-grey-hover{transition:background-color .5s}.bg-grey-hover:hover{background-color:rgba(95,95,95,.336)}.color-white{color:#fff}.color-grey-hover{transition:color .5s}.color-grey-hover:hover{color:#444}.color-black{color:#000}.action-toolbar{height:55px}.top-toolbar-label{font-size:.8em;margin:0}.top-toolbar{height:20px;padding-top:3px}"]}]}],Je.propDecorators={mainActions:[{type:t.Input}]};var Ze=function(){function e(){this.units=["bytes","KB","MB","GB","TB","PB"]}return e.prototype.transform=function(e,t){void 0===t&&(t=0);var n=+e;if(!isFinite(n))return"?";for(var o=0;n>=1024;)n/=1024,o++;return n.toFixed(+t)+" "+this.units[o]},e}();Ze.decorators=[{type:t.Pipe,args:[{name:"fileSize"}]}];var Xe=function(){};Xe.decorators=[{type:t.NgModule,args:[{imports:[n.CommonModule],exports:[Ze],declarations:[Ze],providers:[]}]}];var et=function(){function e(){}return Object.defineProperty(e.prototype,"isChecked",{get:function(){return this.checkedItems.isSelected(this.file.fullPath)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isSelected",{get:function(){return this.selectedItem.isSelected(this.file.fullPath)},enumerable:!1,configurable:!0}),e.prototype.onSelect=function(){this.selectedItem.select(this.file.fullPath)},e.prototype.onCheck=function(){this.checkedItems.select(this.file.fullPath)},e.prototype.onUnCheck=function(){this.checkedItems.deselect(this.file.fullPath)},e}();et.decorators=[{type:t.Component,args:[{selector:"card-file",template:'\n    <div\n      class="flex-row p5 space-between bg-grey-hover rounded"\n      matTooltip="Click For Details"\n      [class.bg-grey-light]="isChecked"\n      [class.bg-grey-dark]="isSelected"\n      (click)="onSelect()"\n    >\n      <div class="flex-row align-center">\n        <mat-icon\n          *ngIf="!isChecked"\n          class="color-white color-grey-hover"\n          (click)="onCheck()"\n          >check_box_outline_blank</mat-icon\n        >\n        <mat-icon\n          *ngIf="isChecked"\n          class="color-black color-grey-hover"\n          (click)="onUnCheck()"\n          >check_box_outline</mat-icon\n        >\n        <img class="mr-10" width="30" [src]="file[\'icon\']" />\n        <div>\n          <h5 class="m0 mb-5 has-ellipsis">{{ file.name }}</h5>\n          <small class="m0 color-grey">{{ file.size | fileSize }}</small>\n        </div>\n      </div>\n      <div class="flex-row align-center">\n        <button\n          mat-icon-button\n          [matMenuTriggerFor]="menu"\n          aria-label="Example icon-button with a menu"\n        >\n          <mat-icon>more_vert</mat-icon>\n        </button>\n      </div>\n    </div>\n    <mat-menu #menu="matMenu">\n      <button\n        mat-menu-item\n        *ngFor="let action of actions"\n        (click)="action.onClick(file)"\n      >\n        <mat-icon [color]="action.color">{{ action.icon }}</mat-icon>\n        <span>{{ action.label }}</span>\n      </button>\n    </mat-menu>\n  ',styles:["h1,h2,h3,h4,h5,h6,i,mat-chip,p,small,span{font-family:sans-serif}.is-red{background:red}.flex-col{display:flex;flex-direction:column}.flex-row{display:flex;flex-direction:row}.align-center{align-items:center}.align-top{align-items:start}.align-bottom{align-items:end}.fit-content{width:-moz-fit-content;width:fit-content}.sans-serif{font-family:sans-serif}.has-pointer{cursor:pointer}.has-ellipsis{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.scroll-x{overflow-x:auto}.full-width{width:100%}.text-center{text-align:center}.space-between{justify-content:space-between}.break-word{overflow-wrap:break-word;word-break:break-all}.capitalize{text-transform:capitalize}.p5{padding:5px}.m0{margin:0}.mb-10{margin-bottom:10px}.mr-10{margin-right:10px}.m-10{margin:10px}.color-grey{color:#8c8c8c}.rounded{border-radius:5px}.bg-grey-light{background-color:rgba(95,95,95,.2)}.bg-grey-dark{background-color:rgba(50,50,50,.39)}.bg-grey-hover{transition:background-color .5s}.bg-grey-hover:hover{background-color:rgba(95,95,95,.336)}.color-white{color:#fff}.color-grey-hover{transition:color .5s}.color-grey-hover:hover{color:#444}.color-black{color:#000}.action-toolbar{height:55px}.top-toolbar-label{font-size:.8em;margin:0}.top-toolbar{height:20px;padding-top:3px}",""]}]}],et.propDecorators={file:[{type:t.Input}],actions:[{type:t.Input}],checkedItems:[{type:t.Input}],selectedItem:[{type:t.Input}]};var tt=function(){function e(){this.enterFolder=new t.EventEmitter}return Object.defineProperty(e.prototype,"isChecked",{get:function(){if(this.checkedItems)return this.checkedItems.isSelected(this.folder.fullPath)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isSelected",{get:function(){return this.selectedItem.isSelected(this.folder.fullPath)},enumerable:!1,configurable:!0}),e.prototype.onSelect=function(){this.selectedItem.select(this.folder.fullPath)},e.prototype.onCheck=function(){this.checkedItems.select(this.folder.fullPath)},e.prototype.onUnCheck=function(){this.checkedItems.deselect(this.folder.fullPath)},e.prototype.onDoubleClick=function(){console.log("onDoubleClick!"),this.enterFolder.emit(this.folder.fullPath)},e.prototype.getFolderSize=function(e){return e.metaData?this.config.folderSizePath.split(".").reduce((function(e,t){return e[t]}),e):e.size},e}();tt.decorators=[{type:t.Component,args:[{selector:"card-folder",template:'\n    <div\n      class="flex-row p5 space-between bg-grey-hover rounded"\n      matTooltip="Click For Details"\n      [class.bg-grey-light]="isChecked"\n      [class.bg-grey-dark]="isSelected"\n      (click)="onSelect()"\n      (dblclick)="onDoubleClick()"\n    >\n      <div class="flex-row align-center">\n        <div *ngIf="checkedItems">\n          <mat-icon\n            *ngIf="!isChecked"\n            class="has-pointer color-white color-grey-hover"\n            (click)="onCheck()"\n            >check_box_outline_blank</mat-icon\n          >\n          <mat-icon\n            *ngIf="isChecked"\n            class="has-pointer color-black color-grey-hover"\n            (click)="onUnCheck()"\n            >check_box_outline</mat-icon\n          >\n        </div>\n        <img class="mr-10" width="30" [src]="folder[\'icon\']" />\n        <div>\n          <h5 class="m0 mb-5 has-ellipsis">{{ folder.name }}</h5>\n          <small *ngIf="config && config.folderSizePath" class="m0 color-grey">{{ getFolderSize(folder) | fileSize }}</small>\n        </div>\n      </div>\n      <button\n        *ngIf="actions"\n        mat-icon-button\n        [matMenuTriggerFor]="menu"\n        aria-label="Example icon-button with a menu"\n      >\n        <mat-icon>more_vert</mat-icon>\n      </button>\n    </div>\n    <mat-menu #menu="matMenu">\n      <button\n        mat-menu-item\n        *ngFor="let action of actions"\n        (click)="action.onClick(folder)"\n      >\n        <mat-icon [color]="action.color">{{ action.icon }}</mat-icon>\n        <span>{{ action.label }}</span>\n      </button>\n    </mat-menu>\n  ',styles:["h1,h2,h3,h4,h5,h6,i,mat-chip,p,small,span{font-family:sans-serif}.is-red{background:red}.flex-col{display:flex;flex-direction:column}.flex-row{display:flex;flex-direction:row}.align-center{align-items:center}.align-top{align-items:start}.align-bottom{align-items:end}.fit-content{width:-moz-fit-content;width:fit-content}.sans-serif{font-family:sans-serif}.has-pointer{cursor:pointer}.has-ellipsis{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.scroll-x{overflow-x:auto}.full-width{width:100%}.text-center{text-align:center}.space-between{justify-content:space-between}.break-word{overflow-wrap:break-word;word-break:break-all}.capitalize{text-transform:capitalize}.p5{padding:5px}.m0{margin:0}.mb-10{margin-bottom:10px}.mr-10{margin-right:10px}.m-10{margin:10px}.color-grey{color:#8c8c8c}.rounded{border-radius:5px}.bg-grey-light{background-color:rgba(95,95,95,.2)}.bg-grey-dark{background-color:rgba(50,50,50,.39)}.bg-grey-hover{transition:background-color .5s}.bg-grey-hover:hover{background-color:rgba(95,95,95,.336)}.color-white{color:#fff}.color-grey-hover{transition:color .5s}.color-grey-hover:hover{color:#444}.color-black{color:#000}.action-toolbar{height:55px}.top-toolbar-label{font-size:.8em;margin:0}.top-toolbar{height:20px;padding-top:3px}",""]}]}],tt.propDecorators={folder:[{type:t.Input}],actions:[{type:t.Input}],checkedItems:[{type:t.Input}],selectedItem:[{type:t.Input}],config:[{type:t.Input}],enterFolder:[{type:t.Output}]};var nt=function(){function e(){this.checkedItems=new g.SelectionModel(!0),this.selectedItem=new g.SelectionModel(!1),this.clearSelected=new s.Subject,this.checkedChanged=new t.EventEmitter,this.selectedChanged=new t.EventEmitter,this.enterFolder=new t.EventEmitter,this.destroyed=new s.Subject}return e.prototype.ngOnInit=function(){var e=this;this.$triggerClearSelected.pipe(i.takeUntil(this.destroyed)).subscribe((function(){return e.checkedItems.clear()})),this.checkedItems.changed.pipe(i.takeUntil(this.destroyed)).subscribe((function(){var t=B(e.folders.filter((function(t){return e.checkedItems.selected.includes(t.fullPath)})),e.files.filter((function(t){return e.checkedItems.selected.includes(t.fullPath)})));e.checkedChanged.emit(t)})),this.selectedItem.changed.pipe(i.takeUntil(this.destroyed)).subscribe((function(){var t=L(e.selectedItem.selected,1)[0];e.selectedChanged.emit(t)}))},e.prototype.ngOnDestroy=function(){this.destroyed.next()},Object.defineProperty(e.prototype,"areAllFoldersChecked",{get:function(){var e=this.checkedItems.selected;return this.folders.every((function(t){return e.includes(t.fullPath)}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"areAllFilesChecked",{get:function(){var e=this.checkedItems.selected;return this.files.every((function(t){return e.includes(t.fullPath)}))},enumerable:!1,configurable:!0}),e.prototype.onCheckAllFolders=function(){var e;(e=this.checkedItems).select.apply(e,B(this.folders.map((function(e){return e.fullPath}))))},e.prototype.onUnCheckAllFolders=function(){var e;(e=this.checkedItems).deselect.apply(e,B(this.folders.map((function(e){return e.fullPath}))))},e.prototype.onCheckAllFiles=function(){var e;(e=this.checkedItems).select.apply(e,B(this.files.map((function(e){return e.fullPath}))))},e.prototype.onUnCheckAllFiles=function(){var e;(e=this.checkedItems).deselect.apply(e,B(this.files.map((function(e){return e.fullPath}))))},e}();nt.decorators=[{type:t.Component,args:[{selector:"app-file-table",template:'\n    <div class="files-viewer full-width">\n      <div *ngIf="folders?.length" class="flex-row align-center">\n        <mat-icon\n          *ngIf="!areAllFoldersChecked"\n          class="has-pointer color-white color-grey-hover"\n          (click)="onCheckAllFolders()"\n          >check_box_outline_blank</mat-icon\n        >\n        <mat-icon\n          *ngIf="areAllFoldersChecked"\n          class="has-pointer color-black color-grey-hover"\n          (click)="onUnCheckAllFolders()"\n          >check_box_outline</mat-icon\n        >\n        <h4 class="p5 m0 color-grey">Folders</h4>\n      </div>\n      <div class="flex-col">\n        <card-folder\n          *ngFor="let folder of folders"\n          [folder]="folder"\n          [config]="config"\n          [checkedItems]="checkedItems"\n          [selectedItem]="selectedItem"\n          [actions]="folderActions"\n          (enterFolder)="enterFolder.emit($event)"\n        >\n        </card-folder>\n      </div>\n      <div *ngIf="files?.length" class="flex-row align-center">\n        <mat-icon\n          *ngIf="!areAllFilesChecked"\n          class="has-pointer color-white color-grey-hover"\n          (click)="onCheckAllFiles()"\n          >check_box_outline_blank</mat-icon\n        >\n        <mat-icon\n          *ngIf="areAllFilesChecked"\n          class="has-pointer color-black color-grey-hover"\n          (click)="onUnCheckAllFiles()"\n          >check_box_outline</mat-icon\n        >\n        <h4 class="p5 m0 color-grey">Files</h4>\n      </div>\n      <div class="flex-col">\n        <card-file\n          *ngFor="let file of files"\n          [file]="file"\n          [checkedItems]="checkedItems"\n          [selectedItem]="selectedItem"\n          [actions]="fileActions"\n        >\n        </card-file>\n      </div>\n      <div class="nothing-here" *ngIf="!files?.length && !folders.length">\n        <p>\n          No folders/files here\n        </p>\n      </div>\n    </div>\n  ',styles:["h1,h2,h3,h4,h5,h6,i,mat-chip,p,small,span{font-family:sans-serif}.is-red{background:red}.flex-col{display:flex;flex-direction:column}.flex-row{display:flex;flex-direction:row}.align-center{align-items:center}.align-top{align-items:start}.align-bottom{align-items:end}.fit-content{width:-moz-fit-content;width:fit-content}.sans-serif{font-family:sans-serif}.has-pointer{cursor:pointer}.has-ellipsis{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.scroll-x{overflow-x:auto}.full-width{width:100%}.text-center{text-align:center}.space-between{justify-content:space-between}.break-word{overflow-wrap:break-word;word-break:break-all}.capitalize{text-transform:capitalize}.p5{padding:5px}.m0{margin:0}.mb-10{margin-bottom:10px}.mr-10{margin-right:10px}.m-10{margin:10px}.color-grey{color:#8c8c8c}.rounded{border-radius:5px}.bg-grey-light{background-color:rgba(95,95,95,.2)}.bg-grey-dark{background-color:rgba(50,50,50,.39)}.bg-grey-hover{transition:background-color .5s}.bg-grey-hover:hover{background-color:rgba(95,95,95,.336)}.color-white{color:#fff}.color-grey-hover{transition:color .5s}.color-grey-hover:hover{color:#444}.color-black{color:#000}.action-toolbar{height:55px}.top-toolbar-label{font-size:.8em;margin:0}.top-toolbar{height:20px;padding-top:3px}","\n      .nothing-here {\n        padding: 20px;\n        padding-bottom: 100px;\n        font-size: 1.2em;\n        color: #777;\n      }\n      .files-viewer {\n        min-height: 500px;\n      }\n    "]}]}],nt.propDecorators={$triggerClearSelected:[{type:t.Input}],fileActions:[{type:t.Input}],folderActions:[{type:t.Input}],files:[{type:t.Input}],folders:[{type:t.Input}],config:[{type:t.Input}],checkedChanged:[{type:t.Output}],selectedChanged:[{type:t.Output}],enterFolder:[{type:t.Output}]};var ot=function(){};ot.decorators=[{type:t.NgModule,args:[{imports:[n.CommonModule,Xe,v.MatMenuModule,m.MatIconModule,b.MatButtonModule,y.MatTooltipModule],exports:[nt,tt],declarations:[et,tt,nt],providers:[]}]}];var rt=function(){};rt.decorators=[{type:t.NgModule,args:[{imports:[n.CommonModule,Xe,b.MatButtonModule,m.MatIconModule,ot,w.MatToolbarModule],exports:[Ye],declarations:[Ye,Je],providers:[]}]}];var it=function(){function e(){this.visible=!0,this.selectable=!0,this.addOnBlur=!0,this.separatorKeysCodes=[x.ENTER,x.COMMA],this.removableTags=!0,this.allowCustom=!0,this.selectChoices$=new s.Observable}return e.prototype.checkExists=function(e,t){if(null==e)throw new Error(t+" has not been defined")},e.prototype.hasRed=function(){var e=this.control.dirty,t=this.control.invalid;return e&&t},e.prototype.ngOnInit=function(){var e=this;this.checkExists(this.control,"this.group"),this.checkExists(this.selectChoices$,"this.selectChoices"),this.selectInitial=this.control.value,this.autoCompleteObscureName=c.v4(),this.selectChoices$=this.selectChoices$.pipe(i.take(1)),this.controlAutocomplete=new o.FormControl([],o.Validators.minLength(1)),this.selectChoices$.subscribe((function(t){e.filteredTags=e.controlAutocomplete.valueChanges.pipe(i.startWith(null),i.map((function(e){return console.log({keyboardInput:e},{selectChoicesArr:t}),e?t.filter((function(t){return!!t&&!!(t.name+"").includes(e)})):t})))})),this.controlAutocomplete.setValue(this.selectInitial),this.control.markAsUntouched()},e.prototype.ngOnDestroy=function(){},e.prototype.add=function(e){if(this.allowCustom&&!this.matAutocomplete.isOpen){var t=e.input,n=e.value;if((n||"").trim()){var o={id:c.v4(),name:n.trim()};this.control.value.push(o)}t&&(t.value=""),this.updateFormValue()}},e.prototype.removeTag=function(e){var t=this.control.value.findIndex((function(t){return t.id===e.id}));t>=0&&this.control.value.splice(t,1),this.updateFormValue()},e.prototype.selectedTag=function(e){console.log(e);var t=e.option.value,n=!0;this.control.value.forEach((function(e){n=e.id!==t.id&&n})),n&&this.control.value.push(t),this.tagInput.nativeElement.value="",this.tagInput.nativeElement.blur(),this.updateFormValue()},e.prototype.updateFormValue=function(){this.controlAutocomplete.reset(),this.control.setValue(this.control.value),this.control.markAsDirty()},e.prototype.getLowerCase=function(e){return e&&e.name?(e.name+"").toLowerCase():null},e}();it.decorators=[{type:t.Component,args:[{selector:"app-control-tag-multiple",template:'\n    <mat-form-field class="full-width" [class.formInvalid]="hasRed()">\n      <mat-chip-list #chipList [disabled]="!removableTags" [multiple]="true">\n        <mat-chip\n          *ngFor="let tag of selectInitial"\n          [selectable]="selectable"\n          [removable]="removableTags"\n          (removed)="removeTag(tag)"\n        >\n          {{ getLowerCase(tag) }}\n          <mat-icon matChipRemove *ngIf="removableTags">cancel</mat-icon>\n        </mat-chip>\n        <input\n          #tagInput\n          [placeholder]="placeholder"\n          [formControl]="controlAutocomplete"\n          [matAutocomplete]="auto"\n          [matChipInputFor]="chipList"\n          [matChipInputSeparatorKeyCodes]="separatorKeysCodes"\n          [matChipInputAddOnBlur]="addOnBlur"\n          (matChipInputTokenEnd)="add($event)"\n          [name]="autoCompleteObscureName"\n        />\n      </mat-chip-list>\n      <mat-icon\n        matTooltip="Add many tags here, you can manage all your tags using the tag list editor in the settings menu"\n        class="tag-icon"\n        matSuffix\n        matBadge="∞"\n        >local_offer</mat-icon\n      >\n      <mat-autocomplete\n        #auto="matAutocomplete"\n        (optionSelected)="selectedTag($event)"\n      >\n        <mat-option\n          *ngFor="let tag of filteredTags | async"\n          [value]="tag"\n          [disabled]="tag[\'isDisabled\']"\n        >\n          {{ tag.name }}\n        </mat-option>\n      </mat-autocomplete>\n    </mat-form-field>\n  ',styles:["\n      .full-width {\n        width: 100%;\n      }\n      .tag-icon {\n        color: grey;\n        right: 15px;\n      }\n      .formInvalid {\n        background-color: #ff4f4f30 !important;\n      }\n      .mat-badge-active {\n        font-size: 18px;\n      }\n      mat-icon span {\n        background-color: transparent;\n        right: 1px !important;\n        top: 1px !important;\n        color: white;\n      }\n    "]}]}],it.propDecorators={tagInput:[{type:t.ViewChild,args:["tagInput",{static:!1}]}],matAutocomplete:[{type:t.ViewChild,args:["auto",{static:!1}]}],placeholder:[{type:t.Input}],displayLowerCase:[{type:t.Input}],control:[{type:t.Input}],removableTags:[{type:t.Input}],allowCustom:[{type:t.Input}],selectChoices$:[{type:t.Input}]};var st=function(){};st.decorators=[{type:t.NgModule,args:[{imports:[n.CommonModule,o.ReactiveFormsModule,o.FormsModule,k.MatChipsModule,C.MatAutocompleteModule,m.MatIconModule,f.MatInputModule,S.MatFormFieldModule],exports:[it],declarations:[it],providers:[]}]}];var at=[Ve,q,re,We,te,ee,oe,Ke,ye],lt=B(at,[Qe]),ct=function(){};ct.decorators=[{type:t.NgModule,args:[{imports:[n.CommonModule,o.FormsModule,o.ReactiveFormsModule,Be,k.MatChipsModule,l.MatDialogModule,S.MatFormFieldModule,b.MatButtonModule,f.MatInputModule,m.MatIconModule,P.MatSelectModule,F.MatCardModule,rt,st],exports:B(at),entryComponents:B(at),declarations:B(lt),providers:[]}]}];var ut=[Pe,De,Ee,Re,Ue],pt=z,ht=function(){};ht.decorators=[{type:t.NgModule,args:[{declarations:ut,imports:[n.CommonModule,o.FormsModule,r.HttpClientModule,o.ReactiveFormsModule,Xe,ot,Be,ct,C.MatAutocompleteModule,b.MatButtonModule,I.MatButtonToggleModule,O.MatCheckboxModule,k.MatChipsModule,F.MatCardModule,l.MatDialogModule,S.MatFormFieldModule,m.MatIconModule,f.MatInputModule,v.MatMenuModule,M.MatPaginatorModule,d.MatProgressBarModule,D.MatProgressSpinnerModule,P.MatSelectModule,E.MatSidenavModule,u.MatSnackBarModule,R.MatSortModule,T.MatTableModule,A.MatTabsModule,w.MatToolbarModule,y.MatTooltipModule,j.MatExpansionModule],exports:[Pe],providers:[qe,ge,ne,{provide:n.APP_BASE_HREF,useFactory:pt,deps:[n.PlatformLocation]},{provide:G,useClass:ie},fe]}]}];var dt=function(){function e(){this.fakeDelayMs=1e3,this.logger=new ie,this.files=ke}return e.prototype.setFakeDelay=function(e){this.fakeDelayMs=e},e.prototype.fakeDelay=function(){return _(this,void 0,void 0,(function(){var e=this;return N(this,(function(t){return[2,new Promise((function(t,n){setTimeout((function(){t()}),e.fakeDelayMs)}))]}))}))},e.prototype.selectMatches=function(e,t){var n=new Set(e);return t?this.files.filter((function(e){return n.has(e.fullPath)})):this.files.filter((function(e){return!n.has(e.fullPath)}))},e.prototype.isInDirectory=function(e,t){try{var n=H.relative(e,t);return n&&!n.startsWith("..")&&!n.includes("/")}catch(n){return this.logger.warn("isInDirectory error",{dirPath:e,filePath:t,error:n}),!1}},e.prototype.List=function(e){return _(this,void 0,void 0,(function(){var t,n,o=this;return N(this,(function(r){switch(r.label){case 0:return[4,this.fakeDelay()];case 1:return r.sent(),t=this.ensurePrefixSlash(this.ensureTrailingSlash(e)),n=this.files.filter((function(e){return o.isInDirectory(t,e.fullPath)})),this.logger.info("List",{folderPath:t,files:this.files,matches:n}),[2,{result:n}]}}))}))},e.prototype.Rename=function(e,t){return _(this,void 0,void 0,(function(){var n;return N(this,(function(o){switch(o.label){case 0:return[4,this.fakeDelay()];case 1:return o.sent(),n=H.basename(t),this.selectMatches([e],!0).map((function(e){e.name=n,e.fullPath=t})),[2,null]}}))}))},e.prototype.Move=function(e,t){return _(this,void 0,void 0,(function(){return N(this,(function(n){switch(n.label){case 0:return[4,this.fakeDelay()];case 1:return n.sent(),this.selectMatches([e],!0).map((function(e){e.fullPath=t})),[2,null]}}))}))},e.prototype.Copy=function(e,t){return _(this,void 0,void 0,(function(){var n=this;return N(this,(function(o){switch(o.label){case 0:return[4,this.fakeDelay()];case 1:return o.sent(),this.selectMatches([e],!0).map((function(e){var o=Object.assign({},e);o.fullPath=t,n.files.push(o)})),[2,null]}}))}))},e.prototype.Edit=function(e,t){return _(this,void 0,void 0,(function(){return N(this,(function(n){switch(n.label){case 0:return[4,this.fakeDelay()];case 1:return n.sent(),this.selectMatches([e],!0).map((function(e){e.content=t})),[2,null]}}))}))},e.prototype.Getcontent=function(e){return _(this,void 0,void 0,(function(){return N(this,(function(t){switch(t.label){case 0:return[4,this.fakeDelay()];case 1:return t.sent(),[2,B(this.selectMatches([e],!0)).pop().content]}}))}))},e.prototype.GetSingle=function(e){return _(this,void 0,void 0,(function(){var t,n;return N(this,(function(o){switch(o.label){case 0:return[4,this.fakeDelay()];case 1:return o.sent(),t=this.selectMatches([e],!0),[2,{result:{file:n=B(t).pop(),url:n.downloadUrl,success:!0}}]}}))}))},e.prototype.CreateFolder=function(e,t){return _(this,void 0,void 0,(function(){var n;return N(this,(function(o){switch(o.label){case 0:return[4,this.fakeDelay()];case 1:return o.sent(),t?(n=Q(e),this.files.push(xe(n))):this.recursivelyTryToCreateFolder(e),[2,null]}}))}))},e.prototype.recursivelyTryToCreateFolder=function(e){var t=Q(e);if(!!this.selectMatches([t],!0).length){var n=X(t);return this.recursivelyTryToCreateFolder(n)}this.files.push(xe(t))},e.prototype.SetPermissions=function(e,t,n,o){return _(this,void 0,void 0,(function(){return N(this,(function(r){return[2,this.SetPermissionsMultiple([e],t,n,o)]}))}))},e.prototype.CopyMultiple=function(e,t){return _(this,void 0,void 0,(function(){var n=this;return N(this,(function(o){switch(o.label){case 0:return[4,this.fakeDelay()];case 1:return o.sent(),this.selectMatches(e,!0).map((function(e){var o=Object.assign({},e);o.fullPath=H.join(t,e.name),n.files.push(o)})),[2,null]}}))}))},e.prototype.MoveMultiple=function(e,t){return _(this,void 0,void 0,(function(){return N(this,(function(n){switch(n.label){case 0:return[4,this.fakeDelay()];case 1:return n.sent(),this.selectMatches(e,!0).map((function(e){e.fullPath=H.join(t,e.name)})),[2,null]}}))}))},e.prototype.SetPermissionsMultiple=function(e,t,n,o){return _(this,void 0,void 0,(function(){return N(this,(function(r){switch(r.label){case 0:return[4,this.fakeDelay()];case 1:return r.sent(),this.logger.info("file-system-stub: SetPermissionsMultiple",{items:e,files:this.files}),[2,this.recursivelySetPermissions(e,t,n,o)]}}))}))},e.prototype.Upload=function(e){return _(this,void 0,void 0,(function(){return N(this,(function(t){switch(t.label){case 0:return[4,this.fakeDelay()];case 1:return t.sent(),this.recursivelyTryToAddFile(e),[2,null]}}))}))},e.prototype.recursivelyTryToAddFile=function(e){var t=J(e);if(!!this.selectMatches([t],!0).length){var n=Z(t);return this.recursivelyTryToAddFile(n)}this.files.push(we(t))},e.prototype.recursivelySetPermissions=function(e,t,n,o){var r=this;return this.selectMatches(e,!0).map((function(e){r.setSinglePermission(e,t,n);var i="dir"===e.type;o&&i&&r.recursivelySetPermissions([e.fullPath],t,n,o)})),null},e.prototype.setSinglePermission=function(e,t,n){var o;"READER"===t&&(o=e.permissions.readers),"WRITER"===t&&(o=e.permissions.writers),o.includes(n)||o.push(n)},e.prototype.SetPermissionsObjectMultiple=function(e,t,n){return _(this,void 0,void 0,(function(){var o;return N(this,(function(r){switch(r.label){case 0:return[4,this.fakeDelay()];case 1:return r.sent(),o=this.selectMatches(e,!0),this.logger.info("file-system-stub: SetPermissionsMultiple",{items:e,matches:o,permissionsObj:t}),this.recursivelySetPermissionsObjects(e,t,n),[2,null]}}))}))},e.prototype.recursivelySetPermissionsObjects=function(e,t,n){var o=this;return this.selectMatches(e,!0).map((function(e){e.permissions=t;var r="dir"===e.type;n&&r&&o.recursivelySetPermissionsObjects([e.fullPath],t,n)})),null},e.prototype.Remove=function(e){return _(this,void 0,void 0,(function(){var t,n;return N(this,(function(o){switch(o.label){case 0:return[4,this.fakeDelay()];case 1:return o.sent(),t=new Set(e),n=this.files.filter((function(e){return!t.has(e.fullPath)})),this.files=n,[2,null]}}))}))},e.prototype.CloneProvider=function(){return new e},e.prototype.ensureTrailingSlash=function(e){return"/"===e.slice(-1)?e:e+"/"},e.prototype.ensurePrefixSlash=function(e){return"/"===e.slice(0,1)?e:"/"+e},e.prototype.GetUploadApiUrl=function(e){return"https://httpbin.org/post"},e.prototype.CreateDownloadLink=function(e){return _(this,void 0,void 0,(function(){return N(this,(function(e){return[2,"https://upload.wikimedia.org/wikipedia/commons/8/85/Exponential_Function_%28Abs_Imag_Part_at_Infinity%29_Density.png"]}))}))},e}();e.FileSystemStub=dt,e.NgxFilemanagerClientFirebaseModule=ht,e.ServerFilesystemProviderService=qe,e.ɵa=Pe,e.ɵb=Ce,e.ɵba=st,e.ɵbb=it,e.ɵbc=Ve,e.ɵbd=q,e.ɵbe=re,e.ɵbf=We,e.ɵbg=te,e.ɵbh=ee,e.ɵbi=oe,e.ɵbj=Ke,e.ɵbk=ye,e.ɵbl=Qe,e.ɵbm=z,e.ɵbn=ie,e.ɵc=me,e.ɵd=G,e.ɵe=fe,e.ɵf=be,e.ɵg=ne,e.ɵh=ge,e.ɵi=De,e.ɵj=Ee,e.ɵk=Re,e.ɵl=Ue,e.ɵm=Xe,e.ɵn=Ze,e.ɵo=ot,e.ɵp=nt,e.ɵq=tt,e.ɵr=et,e.ɵs=Be,e.ɵt=$e,e.ɵu=ze,e.ɵv=Le,e.ɵw=ct,e.ɵx=rt,e.ɵy=Ye,e.ɵz=Je,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=ngx-filemanager-client-firebase.umd.min.js.map